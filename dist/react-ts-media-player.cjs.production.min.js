"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("react")),n=e(require("debounce")),r=function(e){var n=e.config,r=e.children,a=[].concat((void 0===n?{}:n).classNames["sr-only"]||[]);return t.createElement("span",{className:a.join(" ")},r)},a=function(e,t,n,r){return void 0===t&&(t=""),void 0===n&&(n=""),void 0===r&&(r=[]),[].concat(e.split(/\s+/)).concat(t.split(/\s+/)).filter((function(e){return e&&e.length})).map((function(e){return n.length?e+"__"+n:e})).reduce((function(e,t){return e.concat([""].concat(r.filter((function(e){return e&&e.length}))).map((function(e){return t+(e.length?"--"+e:"")})))}),[]).join(" ")},i=function(e){var n=e.enabled,i=void 0===n||n,o=e.hidden,c=void 0!==o&&o,l=e.btnType,u=e.onClick,s=e.children,d=e.className,f=e.config,m=void 0===f?{}:f,v=(m.classNames[l]||[]).join(" "),p=(m.icons[l]||[]).join(" "),g=m.iconElements[l]||null;return t.createElement("button",{className:a(v,d||""),disabled:!i,hidden:c,onClick:u},t.createElement(r,{config:m},s),!g&&t.createElement("span",{className:a(p,"")}),g)},o=function(e,t,n){return Math.max(t,Math.min(n,e))},c=function(e,t){var n=0,r=t.getBoundingClientRect();return"mousemove"===e.type&&(n=e.pageX-r.left),"touchmove"===e.type&&(n=e.targetTouches[0].pageX-r.left),n},l=function(e){if("number"==typeof e.nativeEvent.offsetX)return e.nativeEvent.offsetX;if("object"==typeof e.targetTouches){var t=e,n=t.target.getBoundingClientRect();return t.targetTouches[0].pageX-n.left}return 0},u=function(e){var n=e.style;return t.createElement("div",{style:void 0===n?{}:n,className:e.className||""},e.title)},s=function(e){var n=e.wrapperClassName,r=e.tooltipClassName,a=e.valueToTooltipString,i=void 0===a?function(){return""}:a,o=e.defaultValue,c=void 0===o?0:o,s=e.show,d=void 0!==s&&s,f=t.useRef(null),m=t.useState(c),v=m[0],p=m[1],g=f.current?f.current.clientWidth:0,E=i(v)||"";return t.createElement("div",{ref:f,onMouseMove:function(e){p(l(e)/g)},className:n},d&&E.length>0&&t.createElement(u,{title:i(v),className:r,style:{left:g*v+"px"}}))},d=function(e){var r=e.defaultValue,i=void 0===r?0:r,u=e.useTooltip,d=void 0!==u&&u,f=e.useRange,m=void 0!==f&&f,v=e.useProgress,p=void 0!==v&&v,g=e.valueToTooltipString,E=void 0===g?function(){return""}:g,b=e.id,h=e.className,y=e.label,T=e.onClick,N=t.useRef(null),_=t.useRef(!1),k=t.useState(!1),S=k[0],w=k[1],C=t.useState(o(i,0,1)),x=C[0],j=C[1],L=t.useState(0),M=L[0],R=L[1],F=t.useState(0),D=F[0],O=F[1],P=b||"scrub-bar",U="function"==typeof T?n(T,250):function(){},X=function(e){_.current=!0,R(l(e))},B=function(){_.current&&(_.current=!1,O((new Date).getTime()))},I=function(e){_.current&&R(c(e,N.current))},V=function(e){_.current&&R(c(e,N.current))};return t.useEffect((function(){return document.addEventListener("mousemove",I,!1),document.addEventListener("touchmove",V,!1),document.addEventListener("mouseup",B,!1),document.addEventListener("touchend",B,!1),function(){document.removeEventListener("mousemove",I,!1),document.removeEventListener("touchmove",V,!1),document.removeEventListener("mouseup",B,!1),document.removeEventListener("touchend",B,!1)}}),[]),t.useEffect((function(){j(o(i,0,100))}),[i]),t.useEffect((function(){if(_.current){var e=o(M/N.current.clientWidth,0,1);j(100*e),U(e)}}),[D,M]),t.createElement("div",{className:a(h||"","","",[_.current?"scrubbing":""]),onMouseOver:function(){return w(!0)},onMouseLeave:function(){return w(!1)},onMouseDown:m?function(){}:X,onTouchStart:m?function(){}:X,ref:N},d&&t.createElement(s,{wrapperClassName:h+"__wraptooltip",tooltipClassName:h+"__tooltip",show:S||_.current,valueToTooltipString:E,defaultValue:x}),(p||m)&&t.createElement("label",{htmlFor:m?P+"__scrubrange":P+"__progress"},t.createElement("span",{className:"sr-only"},y||"",x+" percent"),p&&t.createElement("progress",{max:"100",value:x,className:h+"__progress",id:P+"__progress"}),m&&t.createElement("input",{className:h+"__scrubrange",id:P+"__scrubrange",type:"range",min:"0",max:"100",value:x,onMouseDown:X,onTouchStart:X,onChange:function(e){R(parseFloat(e.currentTarget.value)/100*N.current.clientWidth)}})),!m&&t.createElement("div",{className:[h+"__fill"].join(" "),style:{width:x+"%"}},t.createElement("span",{className:"sr-only"},y||"",x+" percent")))},f=function(e){var n,r=e.visible,a=void 0===r||r,i=e.lang,o=e.tracks,c=void 0===o?[]:o,l=e.id,u=e.className,s=t.useState(""),d=s[0],f=s[1],m=t.useState(null),v=m[0],p=m[1],g=function(e){var t,n,r=e.target.activeCues,a="";for(n=0;n<r.length;n+=1)void 0!==(t=r[n]).text&&(a+=t.text);f(a)};return t.useEffect((function(){return v&&v.addEventListener("cuechange",g,!1),function(){v&&v.removeEventListener("cuechange",g,!1)}}),[(n=v,n?[n.kind,n.mode,n.language,n.cues.length].join(","):"")]),t.useEffect((function(){if(i&&i.length&&c&&c.length){var e,t=null;for(e=0;e<c.length;e+=1)if(c[e].language===i){t=c[e];break}p(t)}}),[i,c]),t.createElement("div",{className:[u||"","video-wrapper__subtitle-container"].join(" "),hidden:!a,"aria-hidden":!a,lang:i,id:l,"aria-atomic":"true","aria-live":"polite","aria-relevant":"additions text"},a?d:" ")},m=function(e){var n=e.id,r=e.visible,a=void 0!==r&&r,i=e.children;return t.createElement("ol",{className:["video-wrapper__popup-menu",e.className||""].join(" "),id:n,hidden:!a,"aria-expanded":a},i)},v=function(e){var n=e.selected,r=e.onSelect;return t.createElement("li",null,t.createElement("button",{"data-value":e.value,"data-state":void 0!==n&&n?"active":"inactive",onClick:r,onKeyUp:function(e){"Enter"===e.key&&r(e)}},e.label))},p=function(e){var n,r,a=e.visible,i=void 0!==a&&a,o=e.id,c=e.tracks,l=e.selected,u=e.onSelect,s=e.className,d=function(e){var t=e.target.getAttribute("data-value")||null;"function"==typeof u&&u(t)},f=[t.createElement(v,{key:"_none_",label:"Off",value:null,selected:!l,onSelect:d})];if(c&&c.length)for(r=0;r<c.length;r+=1)f.push(t.createElement(v,{key:(n=c[r]).language+"-"+r,label:n.label,value:n.language,selected:l&&n.language===l,onSelect:d}));return t.createElement(m,{className:[s||"","subtitles-menu"].join(" "),id:o,visible:i},f)},g=function(e){var n=e.enabled,i=void 0===n||n,o=e.hidden,c=void 0!==o&&o,l=e.btnType,u=e.toggleState,s=void 0!==u&&u,d=e.children,f=e.onClick,m=e.className,v=e.config,p=void 0===v?{}:v,g=(p.classNames[l]||[]).join(" "),E=(p.icons[l+"__false"]||[]).join(" "),b=(p.icons[l+"__true"]||[]).join(" "),h=p.iconElements[l+"__false"]||null,y=p.iconElements[l+"__true"]||null;return t.createElement("button",{className:a(g,m||""),disabled:!i,hidden:c,onClick:f},t.createElement(r,{config:p},d),!s&&!h&&t.createElement("span",{className:a(E)}),!s&&h,s&&!y&&t.createElement("span",{className:a(b)}),s&&y)},E=function(e){var n=e.tracklist,r=e.selected,a=void 0===r?0:r,i=e.visible,o=void 0!==i&&i,c=e.onSelect,l=e.id,u=e.className,s=function(e){var t=e.target.getAttribute("data-value")||null;if(null!==t){var n=parseInt(t,10);"function"==typeof c&&c(n)}},d=(void 0===n?[]:n).map((function(e,n){return t.createElement(v,{key:n,label:e.label,value:n,selected:n===a,onSelect:s})}));return t.createElement(m,{className:[u||"","track-menu"].join(" "),id:l,visible:o},d)},b=function(e){return e<10?"0"+e:e.toString()};exports.default=function(e){var n=e.playlist,r=void 0===n?[]:n,o=e.id,c=void 0===o?"audio-player":o,l=e.className,u=e.eventRouter,s=e.crossOrigin,m=e.onEndNextFile,v=void 0!==m&&m,h=e.config,y=void 0===h?{}:h,T=e.singleTrack,N=void 0!==T&&T,_=e.useRangeOnScrubBar,k=void 0!==_&&_,S=e.useProgressOnScrubBar,w=void 0!==S&&S,C=e.onLoad,x=e.onPlay,j=e.onPause,L=e.onEnd,M=t.useRef(null),R=t.useRef(null),F=t.useRef(null),D=t.useState(0),O=D[0],P=D[1],U=t.useState(0),X=U[0],B=U[1],I=t.useState([]),V=I[0],A=I[1],W=t.useState(0),q=W[0],H=W[1],K=t.useState(0),z=K[0],G=K[1],J=t.useState(!1),Q=J[0],Y=J[1],Z=t.useState(!1),$=Z[0],ee=Z[1],te=t.useState(!1),ne=te[0],re=te[1],ae=t.useState(null),ie=ae[0],oe=ae[1],ce=t.useState(!1),le=ce[0],ue=ce[1],se=t.useState(!1),de=se[0],fe=se[1],me=t.useState(!1),ve=me[0],pe=me[1],ge=c+"__captions",Ee=c+"__time-indicator",be=c+"__duration-indicator",he=c+"__track-list",ye=c+"__subtitle-menu",Te=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=!1),"number"!=typeof e?"":y.useHoursInTimestamps&&(t&&e>=3600||O>=3600)?function(e){var t=parseInt(e,10);if(isNaN(t))return"";var n=Math.floor(t/3600),r=Math.floor((t-3600*n)/60),a=t-3600*n-60*r;return b(n)+":"+b(r)+":"+b(a)}(e.toString()):function(e){var t=parseInt(e,10);if(isNaN(t))return"";var n=Math.floor(t/60),r=t-60*n;return b(n)+":"+b(r)}(e.toString())};t.useEffect((function(){M.current.setAttribute("playsinline","playsinline")}),[]),t.useEffect((function(){A(r),H(0)}),[r]);var Ne=q>0,_e=q<V.length-1;t.useEffect((function(){M.current.load(),M.current.currentTime=0,G(0)}),[q]);var ke=function(e){Y(!1),ee(!1),pe(!1),H(e),"function"==typeof C&&C({fileData:V,selectedFile:e})},Se=function(e){return e.transcriptUrl&&e.transcriptUrl.length>0},we=function(){return ve?M.current.textTracks:[]},Ce=V&&V.length&&ve,xe=function(e){fe(!1),oe(e&&e.length?e:null)},je=function(){if(Ce){var e=!1;M.current.paused?(M.current.play(),e=!0):M.current.pause();var t=M.current.currentTime;Y(e),B(t),u&&u.emit("state.playing",e),e?"function"==typeof x&&x({fileData:V,selectedFile:q,currentTime:t}):"function"==typeof j&&j({fileData:V,selectedFile:q,currentTime:t})}},Le=function(){_e&&ke(q+1)},Me=function(){Ce&&(M.current.currentTime-=y.rewindTime||5)},Re=function(){Ce&&(M.current.currentTime+=y.fastForwardTime||5)},Fe=function(){M.current.currentTime=0,ee(!1),B(M.current.currentTime),G(0),u&&u.emit("state.ended",!1)};t.useEffect((function(){var e;for(e=0;e<M.current.textTracks.length;e+=1)M.current.textTracks[e].mode=M.current.textTracks[e].language===ie?"showing":"hidden"}),[ie]);var De=function(e){"backward"===e?Me():"play_pause"===e?je():"reset"===e?Fe():"forward"===e&&Re()};t.useEffect((function(){return u&&u.on("remote.action",De),function(){u&&u.off("remote.action",De)}}),[]);var Oe=V[q]||null;return t.createElement("div",{className:a("video-wrapper",l)},t.createElement("audio",{className:a("video-element",l),"data-oh-audio-player":"1",crossOrigin:s,preload:"metadata",ref:M,onLoadedMetadata:function(){pe(!0),xe(ie),P(M.current.duration)},onEnded:function(){if(v)_e&&(Le(),setTimeout((function(){return je()}),500));else{ee(!0);var e=M.current.currentTime;B(e),u&&(u.emit("state.playing",!1),u.emit("state.ended",!0)),"function"==typeof L&&L({fileData:V,selectedFile:q,currentTime:e})}},onTimeUpdate:function(){O>0&&(G(100/O*M.current.currentTime),B(M.current.currentTime))},"aria-describedby":ge},Oe&&t.createElement("source",{src:Oe.audioUrl,type:"audio/mpeg"}),Oe&&Se(Oe)&&t.createElement("track",{src:Oe.transcriptUrl,kind:"captions",label:"English",srcLang:"en"})),t.createElement("div",{className:a("video-controls",l)},t.createElement(d,{defaultValue:z,className:a("video-controls",l,"progress-bar"),onClick:function(e){M.current.currentTime=e*O,B(e*O)},useTooltip:y.useTooltip||!1,useRange:k,useProgress:w,valueToTooltipString:function(e){return Te(M.current?e*M.current.duration:0)}}),t.createElement("label",{className:"sr-only",htmlFor:Ee},"Time elapsed"),t.createElement("input",{className:a("video-controls",l,"time-elapsed"),id:Ee,readOnly:!0,ref:R,value:Te(X)}),y.showDuration&&t.createElement(t.Fragment,null,t.createElement("label",{className:"sr-only",htmlFor:be},"Duration"),t.createElement("input",{className:a("video-controls",l,"duration"),id:be,readOnly:!0,ref:F,value:Te(O,!0)})),t.createElement("div",{className:"w-100"}),t.createElement("div",{className:a("video-controls",l,"button-wrapper")},t.createElement(g,{btnType:"tracklist","aria-controls":he,enabled:V.length>0&&!N,onClick:function(){fe(!1),ue(!le)},toggleState:le,config:y},"Tracklist"),t.createElement("div",{className:a("video-controls",l,"button-wrapper__space")}),t.createElement(i,{btnType:"previous-audio",enabled:V.length>1&&Ne,onClick:function(){Ne&&ke(q-1)},config:y},"Previous track"),t.createElement(i,{btnType:"backward",onClick:Me,config:y},"Rewind"),t.createElement(g,{btnType:"play",hidden:$,onClick:je,toggleState:Q,config:y},Q?"Pause":"Play"),t.createElement(i,{btnType:"reset",enabled:$,hidden:!$,onClick:Fe,config:y},"Restart"),t.createElement(i,{btnType:"forward",onClick:Re,config:y},"Fast forward"),t.createElement(i,{btnType:"next-audio",enabled:V.length>1&&_e,onClick:Le,config:y},"Next track"),t.createElement(g,{btnType:"closed-captioning","aria-controls":ye,enabled:ve&&Se(Oe),onClick:function(){ue(!1),fe(!de)},toggleState:de,config:y},"Closed captioning"),t.createElement("div",{className:a("video-controls",l,"button-wrapper__space")}),t.createElement(g,{btnType:"mute",onClick:function(){var e=!M.current.muted;M.current.muted=e,re(e)},toggleState:ne,config:y},"Mute"))),t.createElement(p,{visible:de,id:ye,tracks:we(),selected:ie,onSelect:xe}),t.createElement(E,{visible:!N&&le,id:he,tracklist:V,selected:q,onSelect:function(e){ue(!1),ke(e)}}),t.createElement(f,{visible:null!==ie,lang:ie,tracks:we(),id:ge}))};
//# sourceMappingURL=react-ts-media-player.cjs.production.min.js.map
