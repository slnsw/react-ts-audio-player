"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=(e=require("react"))&&"object"==typeof e&&"default"in e?e.default:e,n=function(e){var n=e.config,a=e.children,r=[].concat((void 0===n?{}:n).classNames["sr-only"]||[]);return t.createElement("span",{className:r.join(" ")},a)},a=function(e){var a=e.enabled,r=void 0===a||a,c=e.hidden,i=void 0!==c&&c,l=e.btnType,o=e.onClick,u=e.children,s=e.config,d=void 0===s?{}:s,f=[e.className||""].concat(d.classNames[l]||[]),m=[].concat(d.icons[l]||[]),v=d.icons[l]||null;return t.createElement("button",{className:f.join(" "),disabled:!r,hidden:i,onClick:o},t.createElement(n,{config:d},u),!v&&t.createElement("span",{className:m.join(" ")}),v)},r=function(e){if("number"==typeof e.nativeEvent.offsetX)return e.nativeEvent.offsetX;if("object"==typeof e.targetTouches){var t=e,n=t.target.getBoundingClientRect();return t.targetTouches[0].pageX-n.left}return 0},c=function(e){var n=e.defaultValue,a=void 0===n?0:n,c=e.className,i=e.onClick,l=t.useRef(null),o=t.useState(a),u=o[0],s=o[1],d=t.useState(0),f=d[0],m=d[1],v=t.useState(!1),g=v[0],p=v[1];t.useEffect((function(){s(a)}),[a]),t.useEffect((function(){if(g){var e=f/l.current.clientWidth;s(100*e),"function"==typeof i&&i(e)}}),[g,f]);var E=function(e){p(!0),m(r(e))},b=function(){return p(!1)};return t.createElement("div",{className:[c||""].join(" "),onMouseDown:E,onMouseUp:b,onMouseMove:function(e){g&&m(r(e))},onTouchStart:E,onTouchEnd:b,onTouchMove:function(e){g&&m(r(e))},ref:l},t.createElement("div",{className:[c+"__fill"].join(" "),style:{width:u+"%"}},t.createElement("span",{className:"sr-only"},u+" percent")))},i=function(e){var n,a=e.visible,r=void 0===a||a,c=e.lang,i=e.tracks,l=void 0===i?[]:i,o=e.id,u=e.className,s=t.useState(""),d=s[0],f=s[1],m=t.useState(null),v=m[0],g=m[1],p=function(e){var t,n,a=e.target.activeCues,r="";for(n=0;n<a.length;n+=1)void 0!==(t=a[n]).text&&(r+=t.text);f(r)};return t.useEffect((function(){return v&&v.addEventListener("cuechange",p,!1),function(){v&&v.removeEventListener("cuechange",p,!1)}}),[(n=v,n?[n.kind,n.mode,n.language,n.cues.length].join(","):"")]),t.useEffect((function(){if(c&&c.length&&l&&l.length){var e,t=null;for(e=0;e<l.length;e+=1)if(l[e].language===c){t=l[e];break}g(t)}}),[c,l]),t.createElement("div",{className:[u||"","video-wrapper__subtitle-container"].join(" "),hidden:!r,"aria-hidden":!r,lang:c,id:o,"aria-atomic":"true","aria-live":"polite","aria-relevant":"additions text"},r?d:" ")},l=function(e){var n=e.id,a=e.visible,r=void 0!==a&&a,c=e.children;return t.createElement("ol",{className:["video-wrapper__popup-menu",e.className||""].join(" "),id:n,hidden:!r,"aria-expanded":r},c)},o=function(e){var n=e.selected,a=e.onSelect;return t.createElement("li",null,t.createElement("button",{"data-value":e.value,"data-state":void 0!==n&&n?"active":"inactive",onClick:a,onKeyUp:function(e){"Enter"===e.key&&a(e)}},e.label))},u=function(e){var n,a,r=e.visible,c=void 0!==r&&r,i=e.id,u=e.tracks,s=e.selected,d=e.onSelect,f=e.className,m=function(e){var t=e.target.getAttribute("data-value")||null;"function"==typeof d&&d(t)},v=[t.createElement(o,{key:"_none_",label:"Off",value:null,selected:!s,onSelect:m})];if(u&&u.length)for(a=0;a<u.length;a+=1)v.push(t.createElement(o,{key:(n=u[a]).language+"-"+a,label:n.label,value:n.language,selected:s&&n.language===s,onSelect:m}));return t.createElement(l,{className:[f||"","subtitles-menu"].join(" "),id:i,visible:c},v)},s=function(e){var a=e.enabled,r=void 0===a||a,c=e.hidden,i=void 0!==c&&c,l=e.btnType,o=e.toggleState,u=void 0!==o&&o,s=e.children,d=e.onClick,f=e.config,m=void 0===f?{}:f,v=[e.className||""].concat(m.classNames[l]||[]),g=[].concat(m.icons[l]||[]).concat(m.icons[l+"__false"]||[]),p=[].concat(m.icons[l]||[]).concat(m.icons[l+"__true"]||[]);return t.createElement("button",{className:v.join(" "),disabled:!r,hidden:i,onClick:d},t.createElement(n,{config:m},s),t.createElement("span",{className:g.join(" "),hidden:u}),t.createElement("span",{className:p.join(" "),hidden:!u}))},d=function(e){var n=e.tracklist,a=e.selected,r=void 0===a?0:a,c=e.visible,i=void 0!==c&&c,u=e.onSelect,s=e.id,d=e.className,f=function(e){var t=e.target.getAttribute("data-value")||null;if(null!==t){var n=parseInt(t,10);"function"==typeof u&&u(n)}},m=(void 0===n?[]:n).map((function(e,n){return t.createElement(o,{key:n,label:e.label,value:n,selected:n===r,onSelect:f})}));return t.createElement(l,{className:[d||"","track-menu"].join(" "),id:s,visible:i},m)},f=function(e){return e<10?"0"+e:e.toString()},m=function(e){var t=parseInt(e,10),n=Math.floor(t/60),a=t-60*n;return f(n)+":"+f(a)};exports.default=function(e){var n=e.playlist,r=void 0===n?[]:n,l=e.id,o=void 0===l?"audio-player":l,f=e.eventRouter,v=e.crossOrigin,g=e.onEndNextFile,p=void 0!==g&&g,E=e.config,b=void 0===E?{}:E,h=e.singleTrack,k=void 0!==h&&h,y=t.useState([]),_=y[0],N=y[1],T=t.useState(0),S=T[0],C=T[1],j=t.useState(0),w=j[0],x=j[1],M=t.useState("00:00"),R=M[0],U=M[1],O=t.useState(!1),L=O[0],P=O[1],A=t.useState(!1),F=A[0],X=A[1],I=t.useState(!1),V=I[0],q=I[1],B=t.useState(null),D=B[0],K=B[1],W=t.useState(!1),z=W[0],G=W[1],H=t.useState(!1),J=H[0],Q=H[1],Y=t.useState(!1),Z=Y[0],$=Y[1],ee=o+"__captions",te=o+"__time-indicator",ne=o+"__track-list",ae=o+"__subtitle-menu",re=t.useRef(null),ce=t.useRef(null);t.useEffect((function(){re.current.setAttribute("playsinline","playsinline")}),[]),t.useEffect((function(){N(r),C(0)}),[r]);var ie=S>0,le=S<_.length-1;t.useEffect((function(){re.current.load(),re.current.currentTime=0,x(0)}),[S]);var oe=function(e){P(!1),X(!1),$(!1),C(e)},ue=function(e){return e.transcriptUrl&&e.transcriptUrl.length>0},se=function(){return Z?re.current.textTracks:[]},de=_&&_.length&&Z,fe=function(e){Q(!1),K(e&&e.length?e:null)},me=function(){if(de){var e=!1;re.current.paused?(re.current.play(),e=!0):re.current.pause(),P(e),U(m(re.current.currentTime)),f&&f.emit("state.playing",e)}},ve=function(){le&&oe(S+1)},ge=function(){de&&(re.current.currentTime-=5)},pe=function(){de&&(re.current.currentTime+=5)},Ee=function(){re.current.currentTime=0,X(!1),U(m(re.current.currentTime)),x(0),f&&f.emit("state.ended",!1)};t.useEffect((function(){var e;for(e=0;e<re.current.textTracks.length;e+=1)re.current.textTracks[e].mode=re.current.textTracks[e].language===D?"showing":"hidden"}),[D]);var be=function(e){"backward"===e?ge():"play_pause"===e?me():"reset"===e?Ee():"forward"===e&&pe()};t.useEffect((function(){return f&&f.on("remote.action",be),function(){f&&f.off("remote.action",be)}}),[]);var he=_[S]||null;return t.createElement("div",{className:"video-wrapper"},t.createElement("audio",{className:"video-element","data-oh-audio-player":"1",crossOrigin:v,preload:"metadata",ref:re,onLoadedMetadata:function(){$(!0),fe(D)},onEnded:function(){p?le&&(ve(),setTimeout((function(){return me()}),500)):(X(!0),U(m(re.current.currentTime)),f&&(f.emit("state.playing",!1),f.emit("state.ended",!0)))},onTimeUpdate:function(){re.current.duration>0&&(x(100/re.current.duration*re.current.currentTime),U(m(re.current.currentTime)))},"aria-describedby":ee},he&&t.createElement("source",{src:he.audioUrl,type:"audio/mpeg"}),he&&ue(he)&&t.createElement("track",{src:he.transcriptUrl,kind:"captions",label:"English",srcLang:"en"})),t.createElement("div",{className:"video-controls"},t.createElement(c,{defaultValue:w,className:"video-controls__progress-bar",onClick:function(e){re.current.currentTime=e*re.current.duration}}),t.createElement("label",{className:"sr-only",htmlFor:te},"Time elapsed"),t.createElement("input",{className:"video-controls__time-elapsed",id:te,readOnly:!0,ref:ce,value:R}),t.createElement("div",{className:"w-100"}),t.createElement("div",{className:"video-controls__button-wrapper"},t.createElement(s,{btnType:"tracklist","aria-controls":ne,enabled:_.length>0&&!k,onClick:function(){Q(!1),G(!z)},toggleState:z,config:b},"Tracklist"),t.createElement("div",{className:"video-controls__button-wrapper__space"}),t.createElement(a,{btnType:"previous-audio",enabled:_.length>1&&ie,onClick:function(){ie&&oe(S-1)},config:b},"Previous track"),t.createElement(a,{btnType:"backward",onClick:ge,config:b},"Rewind"),t.createElement(s,{btnType:"play",hidden:F,onClick:me,toggleState:L,config:b},L?"Pause":"Play"),t.createElement(a,{btnType:"reset",enabled:F,hidden:!F,onClick:Ee,config:b},"Restart"),t.createElement(a,{btnType:"forward",onClick:pe,config:b},"Fast forward"),t.createElement(a,{btnType:"next-audio",enabled:_.length>1&&le,onClick:ve,config:b},"Next track"),t.createElement(s,{btnType:"closed-captioning","aria-controls":ae,enabled:Z&&ue(he),onClick:function(){G(!1),Q(!J)},toggleState:J,config:b},"Closed captioning"),t.createElement("div",{className:"video-controls__button-wrapper__space"}),t.createElement(s,{btnType:"mute",onClick:function(){var e=!re.current.muted;re.current.muted=e,q(e)},toggleState:V,config:b},"Mute"))),t.createElement(u,{visible:J,id:ae,tracks:se(),selected:D,onSelect:fe}),t.createElement(d,{visible:!k&&z,id:ne,tracklist:_,selected:S,onSelect:function(e){G(!1),oe(e)}}),t.createElement(i,{visible:null!==D,lang:D,tracks:se(),id:ee}))};
//# sourceMappingURL=react-ts-media-player.cjs.production.min.js.map
