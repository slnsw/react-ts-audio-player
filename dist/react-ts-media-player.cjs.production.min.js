"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("react")),n=e(require("debounce")),r=function(e){var n=e.config,r=e.children,a=[].concat((void 0===n?{}:n).classNames["sr-only"]||[]);return t.createElement("span",{className:a.join(" ")},r)},a=function(e,t,n,r){return void 0===t&&(t=""),void 0===n&&(n=""),void 0===r&&(r=[]),[].concat(e.split(/\s+/)).concat(t.split(/\s+/)).filter((function(e){return e&&e.length})).map((function(e){return n.length?e+"__"+n:e})).reduce((function(e,t){return e.concat([""].concat(r.filter((function(e){return e&&e.length}))).map((function(e){return t+(e.length?"--"+e:"")})))}),[]).join(" ")},i=function(e){var n=e.enabled,i=void 0===n||n,o=e.hidden,c=void 0!==o&&o,l=e.btnType,u=e.onClick,s=e.children,d=e.className,f=e.config,m=void 0===f?{}:f,v=(m.classNames[l]||[]).join(" "),p=(m.icons[l]||[]).join(" "),g=m.iconElements[l]||null;return t.createElement("button",{className:a(v,d||""),disabled:!i,hidden:c,onClick:u},t.createElement(r,{config:m},s),!g&&t.createElement("span",{className:a(p,"")}),g)},o=function(e,t,n){return Math.max(t,Math.min(n,e))},c=function(e,t){var n=0,r=t.getBoundingClientRect();return"mousemove"===e.type&&(n=e.pageX-r.left),"touchmove"===e.type&&(n=e.targetTouches[0].pageX-r.left),n},l=function(e){if("number"==typeof e.nativeEvent.offsetX)return e.nativeEvent.offsetX;if("object"==typeof e.targetTouches){var t=e,n=t.target.getBoundingClientRect();return t.targetTouches[0].pageX-n.left}return 0},u=function(e){var n=e.style;return t.createElement("div",{style:void 0===n?{}:n,className:e.className||""},e.title)},s=function(e){var n=e.wrapperClassName,r=e.tooltipClassName,a=e.valueToTooltipString,i=void 0===a?function(){return""}:a,o=e.defaultValue,c=void 0===o?0:o,s=e.show,d=void 0!==s&&s,f=t.useRef(null),m=t.useState(c),v=m[0],p=m[1],g=f.current?f.current.clientWidth:0,E=i(v)||"";return t.createElement("div",{ref:f,onMouseMove:function(e){p(l(e)/g)},className:n},d&&E.length>0&&t.createElement(u,{title:i(v),className:r,style:{left:g*v+"px"}}))},d=function(e){var r=e.defaultValue,i=void 0===r?0:r,u=e.useTooltip,d=void 0!==u&&u,f=e.useRange,m=void 0!==f&&f,v=e.useProgress,p=void 0!==v&&v,g=e.valueToTooltipString,E=void 0===g?function(){return""}:g,b=e.id,h=e.className,y=e.label,T=e.onClick,N=t.useRef(null),_=t.useRef(!1),k=t.useState(!1),S=k[0],w=k[1],C=t.useState(o(i,0,1)),x=C[0],j=C[1],L=t.useState(0),M=L[0],R=L[1],F=t.useState(0),D=F[0],O=F[1],P=b||"scrub-bar",U="function"==typeof T?n(T,250):function(){},X=function(e){_.current=!0,R(l(e))},B=function(){_.current&&(_.current=!1,O((new Date).getTime()))},I=function(e){_.current&&R(c(e,N.current))},V=function(e){_.current&&R(c(e,N.current))};return t.useEffect((function(){return document.addEventListener("mousemove",I,!1),document.addEventListener("touchmove",V,!1),document.addEventListener("mouseup",B,!1),document.addEventListener("touchend",B,!1),function(){document.removeEventListener("mousemove",I,!1),document.removeEventListener("touchmove",V,!1),document.removeEventListener("mouseup",B,!1),document.removeEventListener("touchend",B,!1)}}),[]),t.useEffect((function(){j(o(i,0,100))}),[i]),t.useEffect((function(){if(_.current){var e=o(M/N.current.clientWidth,0,1);j(100*e),U(e)}}),[D,M]),t.createElement("div",{className:a(h||"","","",[_.current?"scrubbing":""]),onMouseOver:function(){return w(!0)},onMouseLeave:function(){return w(!1)},onMouseDown:m?function(){}:X,onTouchStart:m?function(){}:X,ref:N},d&&t.createElement(s,{wrapperClassName:h+"__wraptooltip",tooltipClassName:h+"__tooltip",show:S||_.current,valueToTooltipString:E,defaultValue:x}),(p||m)&&t.createElement("label",{htmlFor:m?P+"__scrubrange":P+"__progress"},t.createElement("span",{className:"sr-only"},y||"",x+" percent"),p&&t.createElement("progress",{max:"100",value:x,className:h+"__progress",id:P+"__progress"}),m&&t.createElement("input",{className:h+"__scrubrange",id:P+"__scrubrange",type:"range",min:"0",max:"100",value:x,onMouseDown:X,onTouchStart:X,onChange:function(e){R(parseFloat(e.currentTarget.value)/100*N.current.clientWidth)}})),!m&&t.createElement("div",{className:[h+"__fill"].join(" "),style:{width:x+"%"}},t.createElement("span",{className:"sr-only"},y||"",x+" percent")))},f=function(e){var n,r=e.visible,a=void 0===r||r,i=e.lang,o=e.tracks,c=void 0===o?[]:o,l=e.id,u=e.className,s=t.useState(""),d=s[0],f=s[1],m=t.useState(null),v=m[0],p=m[1],g=function(e){var t,n,r=e.target.activeCues,a="";for(n=0;n<r.length;n+=1)void 0!==(t=r[n]).text&&(a+=t.text);f(a)};return t.useEffect((function(){return v&&v.addEventListener("cuechange",g,!1),function(){v&&v.removeEventListener("cuechange",g,!1)}}),[(n=v,n?[n.kind,n.mode,n.language,n.cues.length].join(","):"")]),t.useEffect((function(){if(i&&i.length&&c&&c.length){var e,t=null;for(e=0;e<c.length;e+=1)if(c[e].language===i){t=c[e];break}p(t)}}),[i,c]),t.createElement("div",{className:[u||"","video-wrapper__subtitle-container"].join(" "),hidden:!a,"aria-hidden":!a,lang:i,id:l,"aria-atomic":"true","aria-live":"polite","aria-relevant":"additions text"},a?d:" ")},m=function(e){var n=e.id,r=e.visible,a=void 0!==r&&r,i=e.children;return t.createElement("ol",{className:["video-wrapper__popup-menu",e.className||""].join(" "),id:n,hidden:!a,"aria-expanded":a},i)},v=function(e){var n=e.selected,r=e.onSelect;return t.createElement("li",null,t.createElement("button",{"data-value":e.value,"data-state":void 0!==n&&n?"active":"inactive",onClick:r,onKeyUp:function(e){"Enter"===e.key&&r(e)}},e.label))},p=function(e){var n,r,a=e.visible,i=void 0!==a&&a,o=e.id,c=e.tracks,l=e.selected,u=e.onSelect,s=e.className,d=function(e){var t=e.target.getAttribute("data-value")||null;"function"==typeof u&&u(t)},f=[t.createElement(v,{key:"_none_",label:"Off",value:null,selected:!l,onSelect:d})];if(c&&c.length)for(r=0;r<c.length;r+=1)f.push(t.createElement(v,{key:(n=c[r]).language+"-"+r,label:n.label,value:n.language,selected:l&&n.language===l,onSelect:d}));return t.createElement(m,{className:[s||"","subtitles-menu"].join(" "),id:o,visible:i},f)},g=function(e){var n=e.enabled,i=void 0===n||n,o=e.hidden,c=void 0!==o&&o,l=e.btnType,u=e.toggleState,s=void 0!==u&&u,d=e.children,f=e.onClick,m=e.className,v=e.config,p=void 0===v?{}:v,g=(p.classNames[l]||[]).join(" "),E=(p.icons[l+"__false"]||[]).join(" "),b=(p.icons[l+"__true"]||[]).join(" "),h=p.iconElements[l+"__false"]||null,y=p.iconElements[l+"__true"]||null;return t.createElement("button",{className:a(g,m||""),disabled:!i,hidden:c,onClick:f},t.createElement(r,{config:p},d),!s&&!h&&t.createElement("span",{className:a(E)}),!s&&h,s&&!y&&t.createElement("span",{className:a(b)}),s&&y)},E=function(e){var n=e.tracklist,r=e.selected,a=void 0===r?0:r,i=e.visible,o=void 0!==i&&i,c=e.onSelect,l=e.id,u=e.className,s=function(e){var t=e.target.getAttribute("data-value")||null;if(null!==t){var n=parseInt(t,10);"function"==typeof c&&c(n)}},d=(void 0===n?[]:n).map((function(e,n){return t.createElement(v,{key:n,label:e.label,value:n,selected:n===a,onSelect:s})}));return t.createElement(m,{className:[u||"","track-menu"].join(" "),id:l,visible:o},d)},b=function(e){return e<10?"0"+e:e.toString()};exports.default=function(e){var n=e.playlist,r=void 0===n?[]:n,o=e.id,c=void 0===o?"audio-player":o,l=e.className,u=e.eventRouter,s=e.crossOrigin,m=e.onEndNextFile,v=void 0!==m&&m,h=e.config,y=void 0===h?{}:h,T=e.singleTrack,N=void 0!==T&&T,_=e.useRangeOnScrubBar,k=void 0!==_&&_,S=e.useProgressOnScrubBar,w=void 0!==S&&S,C=e.onLoad,x=e.onPlay,j=e.onPause,L=e.onEnd,M=e.onTimeUpdate,R=t.useRef(null),F=t.useRef(null),D=t.useRef(null),O=t.useState(0),P=O[0],U=O[1],X=t.useState(0),B=X[0],I=X[1],V=t.useState([]),A=V[0],W=V[1],q=t.useState(0),H=q[0],K=q[1],z=t.useState(0),G=z[0],J=z[1],Q=t.useState(!1),Y=Q[0],Z=Q[1],$=t.useState(!1),ee=$[0],te=$[1],ne=t.useState(!1),re=ne[0],ae=ne[1],ie=t.useState(null),oe=ie[0],ce=ie[1],le=t.useState(!1),ue=le[0],se=le[1],de=t.useState(!1),fe=de[0],me=de[1],ve=t.useState(!1),pe=ve[0],ge=ve[1],Ee=c+"__captions",be=c+"__time-indicator",he=c+"__duration-indicator",ye=c+"__track-list",Te=c+"__subtitle-menu",Ne=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=!1),"number"!=typeof e?"":y.useHoursInTimestamps&&(t&&e>=3600||P>=3600)?function(e){var t=parseInt(e,10);if(isNaN(t))return"";var n=Math.floor(t/3600),r=Math.floor((t-3600*n)/60),a=t-3600*n-60*r;return b(n)+":"+b(r)+":"+b(a)}(e.toString()):function(e){var t=parseInt(e,10);if(isNaN(t))return"";var n=Math.floor(t/60),r=t-60*n;return b(n)+":"+b(r)}(e.toString())};t.useEffect((function(){R.current.setAttribute("playsinline","playsinline")}),[]),t.useEffect((function(){W(r),K(0)}),[r]);var _e=H>0,ke=H<A.length-1;t.useEffect((function(){R.current.load(),R.current.currentTime=0,J(0)}),[H]);var Se=function(e){Z(!1),te(!1),ge(!1),K(e),"function"==typeof C&&C({fileData:A,selectedFile:e,duration:P})},we=function(e){return e.transcriptUrl&&e.transcriptUrl.length>0},Ce=function(){return pe?R.current.textTracks:[]},xe=A&&A.length&&pe,je=function(e){me(!1),ce(e&&e.length?e:null)},Le=function(){if(xe){var e=!1;R.current.paused?(R.current.play(),e=!0):R.current.pause();var t=R.current.currentTime;Z(e),I(t),u&&u.emit("state.playing",e),e?"function"==typeof x&&x({fileData:A,selectedFile:H,currentTime:t,duration:P}):"function"==typeof j&&j({fileData:A,selectedFile:H,currentTime:t,duration:P})}},Me=function(){ke&&Se(H+1)},Re=function(){xe&&(R.current.currentTime-=y.rewindTime||5)},Fe=function(){xe&&(R.current.currentTime+=y.fastForwardTime||5)},De=function(){R.current.currentTime=0,te(!1),I(R.current.currentTime),J(0),u&&u.emit("state.ended",!1)};t.useEffect((function(){var e;for(e=0;e<R.current.textTracks.length;e+=1)R.current.textTracks[e].mode=R.current.textTracks[e].language===oe?"showing":"hidden"}),[oe]);var Oe=function(e){"backward"===e?Re():"play_pause"===e?Le():"reset"===e?De():"forward"===e&&Fe()};t.useEffect((function(){return u&&u.on("remote.action",Oe),function(){u&&u.off("remote.action",Oe)}}),[]);var Pe=A[H]||null;return t.createElement("div",{className:a("video-wrapper",l)},t.createElement("audio",{className:a("video-element",l),"data-oh-audio-player":"1",crossOrigin:s,preload:"metadata",ref:R,onLoadedMetadata:function(){ge(!0),je(oe),U(R.current.duration)},onEnded:function(){if(v)ke&&(Me(),setTimeout((function(){return Le()}),500));else{te(!0);var e=R.current.currentTime;I(e),u&&(u.emit("state.playing",!1),u.emit("state.ended",!0)),"function"==typeof L&&L({fileData:A,selectedFile:H,currentTime:e,duration:P})}},onTimeUpdate:function(){var e=R.current.currentTime;P>0&&(J(100/P*e),I(e)),"function"==typeof M&&M({fileData:A,selectedFile:H,currentTime:e,duration:P})},"aria-describedby":Ee},Pe&&t.createElement("source",{src:Pe.audioUrl,type:"audio/mpeg"}),Pe&&we(Pe)&&t.createElement("track",{src:Pe.transcriptUrl,kind:"captions",label:"English",srcLang:"en"})),t.createElement("div",{className:a("video-controls",l)},t.createElement(d,{defaultValue:G,className:a("video-controls",l,"progress-bar"),onClick:function(e){R.current.currentTime=e*P,I(e*P)},useTooltip:y.useTooltip||!1,useRange:k,useProgress:w,valueToTooltipString:function(e){return Ne(R.current?e*R.current.duration:0)}}),t.createElement("label",{className:"sr-only",htmlFor:be},"Time elapsed"),t.createElement("input",{className:a("video-controls",l,"time-elapsed"),id:be,readOnly:!0,ref:F,value:Ne(B)}),y.showDuration&&t.createElement(t.Fragment,null,t.createElement("label",{className:"sr-only",htmlFor:he},"Duration"),t.createElement("input",{className:a("video-controls",l,"duration"),id:he,readOnly:!0,ref:D,value:Ne(P,!0)})),t.createElement("div",{className:"w-100"}),t.createElement("div",{className:a("video-controls",l,"button-wrapper")},t.createElement(g,{btnType:"tracklist","aria-controls":ye,enabled:A.length>0&&!N,onClick:function(){me(!1),se(!ue)},toggleState:ue,config:y},"Tracklist"),t.createElement("div",{className:a("video-controls",l,"button-wrapper__space")}),t.createElement(i,{btnType:"previous-audio",enabled:A.length>1&&_e,onClick:function(){_e&&Se(H-1)},config:y},"Previous track"),t.createElement(i,{btnType:"backward",onClick:Re,config:y},"Rewind"),t.createElement(g,{btnType:"play",hidden:ee,onClick:Le,toggleState:Y,config:y},Y?"Pause":"Play"),t.createElement(i,{btnType:"reset",enabled:ee,hidden:!ee,onClick:De,config:y},"Restart"),t.createElement(i,{btnType:"forward",onClick:Fe,config:y},"Fast forward"),t.createElement(i,{btnType:"next-audio",enabled:A.length>1&&ke,onClick:Me,config:y},"Next track"),t.createElement(g,{btnType:"closed-captioning","aria-controls":Te,enabled:pe&&we(Pe),onClick:function(){se(!1),me(!fe)},toggleState:fe,config:y},"Closed captioning"),t.createElement("div",{className:a("video-controls",l,"button-wrapper__space")}),t.createElement(g,{btnType:"mute",onClick:function(){var e=!R.current.muted;R.current.muted=e,ae(e)},toggleState:re,config:y},"Mute"))),t.createElement(p,{visible:fe,id:Te,tracks:Ce(),selected:oe,onSelect:je}),t.createElement(E,{visible:!N&&ue,id:ye,tracklist:A,selected:H,onSelect:function(e){se(!1),Se(e)}}),t.createElement(f,{visible:null!==oe,lang:oe,tracks:Ce(),id:Ee}))};
//# sourceMappingURL=react-ts-media-player.cjs.production.min.js.map
