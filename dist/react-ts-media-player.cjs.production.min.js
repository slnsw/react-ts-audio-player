"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("react")),n=e(require("debounce")),r=function(e){var n=e.config,r=e.children,a=[].concat((void 0===n?{}:n).classNames["sr-only"]||[]);return t.createElement("span",{className:a.join(" ")},r)},a=function(e,t,n,r){return void 0===t&&(t=""),void 0===n&&(n=""),void 0===r&&(r=[]),[].concat(e.split(/\s+/)).concat(t.split(/\s+/)).filter((function(e){return e&&e.length})).map((function(e){return n.length?e+"__"+n:e})).reduce((function(e,t){return e.concat([""].concat(r.filter((function(e){return e&&e.length}))).map((function(e){return t+(e.length?"--"+e:"")})))}),[]).join(" ")},i=function(e){var n=e.enabled,i=void 0===n||n,o=e.hidden,c=void 0!==o&&o,l=e.btnType,u=e.onClick,s=e.children,d=e.className,f=e.config,m=void 0===f?{}:f,v=(m.classNames[l]||[]).join(" "),p=(m.icons[l]||[]).join(" "),g=m.iconElements[l]||null;return t.createElement("button",{className:a(v,d||""),disabled:!i,hidden:c,onClick:u},t.createElement(r,{config:m},s),!g&&t.createElement("span",{className:a(p,"")}),g)},o=function(e,t,n){return Math.max(t,Math.min(n,e))},c=function(e,t){var n=0,r=t.getBoundingClientRect();return"mousemove"===e.type&&(n=e.pageX-r.left),"touchmove"===e.type&&(n=e.targetTouches[0].pageX-r.left),n},l=function(e){if("number"==typeof e.nativeEvent.offsetX)return e.nativeEvent.offsetX;if("object"==typeof e.targetTouches){var t=e,n=t.target.getBoundingClientRect();return t.targetTouches[0].pageX-n.left}return 0},u=function(e){var n=e.style;return t.createElement("div",{style:void 0===n?{}:n,className:e.className||""},e.title)},s=function(e){var n=e.tooltipClassName,r=e.valueToTooltipString,a=void 0===r?function(){return""}:r,i=e.defaultValue,o=void 0===i?0:i,c=e.show,s=void 0!==c&&c,d=t.useRef(null),f=t.useState(o),m=f[0],v=f[1],p=d.current?d.current.clientWidth:0,g=a(m)||"";return t.createElement("div",{ref:d,style:{position:"absolute",top:"-100%",left:0,width:"100%",height:"300%"},onMouseMove:function(e){v(l(e)/p)}},s&&g.length>0&&t.createElement(u,{title:a(m),className:n,style:{left:p*m+"px"}}))},d=function(e){var r=e.defaultValue,a=void 0===r?0:r,i=e.useTooltip,u=void 0!==i&&i,d=e.valueToTooltipString,f=void 0===d?function(){return""}:d,m=e.className,v=e.onClick,p=t.useRef(null),g=t.useRef(!1),E=t.useState(!1),h=E[0],b=E[1],y=t.useState(o(a,0,1)),T=y[0],N=y[1],k=t.useState(0),S=k[0],_=k[1],w=t.useState(0),C=w[0],j=w[1],x="function"==typeof v?n(v,250):function(){},L=function(e){g.current=!0,_(l(e))},M=function(){g.current&&(g.current=!1,j((new Date).getTime()))},R=function(e){g.current&&_(c(e,p.current))},O=function(e){g.current&&_(c(e,p.current))};return t.useEffect((function(){return document.addEventListener("mousemove",R,!1),document.addEventListener("touchmove",O,!1),document.addEventListener("mouseup",M,!1),document.addEventListener("touchend",M,!1),function(){document.removeEventListener("mousemove",R,!1),document.removeEventListener("touchmove",O,!1),document.removeEventListener("mouseup",M,!1),document.removeEventListener("touchend",M,!1)}}),[]),t.useEffect((function(){N(o(a,0,100))}),[a]),t.useEffect((function(){if(g.current){var e=o(S/p.current.clientWidth,0,1);N(100*e),x(e)}}),[C,S]),t.createElement("div",{className:[m||""].join(" "),onMouseOver:function(){return b(!0)},onMouseLeave:function(){return b(!1)},onMouseDown:L,onTouchStart:L,ref:p},u&&t.createElement(s,{tooltipClassName:m+"__tooltip",show:h||g.current,valueToTooltipString:f,defaultValue:T}),t.createElement("div",{className:[m+"__fill"].join(" "),style:{width:T+"%"}},t.createElement("span",{className:"sr-only"},T+" percent")))},f=function(e){var n,r=e.visible,a=void 0===r||r,i=e.lang,o=e.tracks,c=void 0===o?[]:o,l=e.id,u=e.className,s=t.useState(""),d=s[0],f=s[1],m=t.useState(null),v=m[0],p=m[1],g=function(e){var t,n,r=e.target.activeCues,a="";for(n=0;n<r.length;n+=1)void 0!==(t=r[n]).text&&(a+=t.text);f(a)};return t.useEffect((function(){return v&&v.addEventListener("cuechange",g,!1),function(){v&&v.removeEventListener("cuechange",g,!1)}}),[(n=v,n?[n.kind,n.mode,n.language,n.cues.length].join(","):"")]),t.useEffect((function(){if(i&&i.length&&c&&c.length){var e,t=null;for(e=0;e<c.length;e+=1)if(c[e].language===i){t=c[e];break}p(t)}}),[i,c]),t.createElement("div",{className:[u||"","video-wrapper__subtitle-container"].join(" "),hidden:!a,"aria-hidden":!a,lang:i,id:l,"aria-atomic":"true","aria-live":"polite","aria-relevant":"additions text"},a?d:" ")},m=function(e){var n=e.id,r=e.visible,a=void 0!==r&&r,i=e.children;return t.createElement("ol",{className:["video-wrapper__popup-menu",e.className||""].join(" "),id:n,hidden:!a,"aria-expanded":a},i)},v=function(e){var n=e.selected,r=e.onSelect;return t.createElement("li",null,t.createElement("button",{"data-value":e.value,"data-state":void 0!==n&&n?"active":"inactive",onClick:r,onKeyUp:function(e){"Enter"===e.key&&r(e)}},e.label))},p=function(e){var n,r,a=e.visible,i=void 0!==a&&a,o=e.id,c=e.tracks,l=e.selected,u=e.onSelect,s=e.className,d=function(e){var t=e.target.getAttribute("data-value")||null;"function"==typeof u&&u(t)},f=[t.createElement(v,{key:"_none_",label:"Off",value:null,selected:!l,onSelect:d})];if(c&&c.length)for(r=0;r<c.length;r+=1)f.push(t.createElement(v,{key:(n=c[r]).language+"-"+r,label:n.label,value:n.language,selected:l&&n.language===l,onSelect:d}));return t.createElement(m,{className:[s||"","subtitles-menu"].join(" "),id:o,visible:i},f)},g=function(e){var n=e.enabled,i=void 0===n||n,o=e.hidden,c=void 0!==o&&o,l=e.btnType,u=e.toggleState,s=void 0!==u&&u,d=e.children,f=e.onClick,m=e.className,v=e.config,p=void 0===v?{}:v,g=(p.classNames[l]||[]).join(" "),E=(p.icons[l+"__false"]||[]).join(" "),h=(p.icons[l+"__true"]||[]).join(" "),b=p.iconElements[l+"__false"]||null,y=p.iconElements[l+"__true"]||null;return t.createElement("button",{className:a(g,m||""),disabled:!i,hidden:c,onClick:f},t.createElement(r,{config:p},d),!s&&!b&&t.createElement("span",{className:a(E)}),!s&&b,s&&!y&&t.createElement("span",{className:a(h)}),s&&y)},E=function(e){var n=e.tracklist,r=e.selected,a=void 0===r?0:r,i=e.visible,o=void 0!==i&&i,c=e.onSelect,l=e.id,u=e.className,s=function(e){var t=e.target.getAttribute("data-value")||null;if(null!==t){var n=parseInt(t,10);"function"==typeof c&&c(n)}},d=(void 0===n?[]:n).map((function(e,n){return t.createElement(v,{key:n,label:e.label,value:n,selected:n===a,onSelect:s})}));return t.createElement(m,{className:[u||"","track-menu"].join(" "),id:l,visible:o},d)},h=function(e){return e<10?"0"+e:e.toString()};exports.default=function(e){var n=e.playlist,r=void 0===n?[]:n,o=e.id,c=void 0===o?"audio-player":o,l=e.className,u=e.eventRouter,s=e.crossOrigin,m=e.onEndNextFile,v=void 0!==m&&m,b=e.config,y=void 0===b?{}:b,T=e.singleTrack,N=void 0!==T&&T,k=t.useRef(null),S=t.useRef(null),_=t.useRef(null),w=t.useState(0),C=w[0],j=w[1],x=t.useState(0),L=x[0],M=x[1],R=t.useState([]),O=R[0],F=R[1],U=t.useState(0),X=U[0],D=U[1],I=t.useState(0),P=I[0],V=I[1],A=t.useState(!1),q=A[0],B=A[1],W=t.useState(!1),H=W[0],K=W[1],z=t.useState(!1),G=z[0],J=z[1],Q=t.useState(null),Y=Q[0],Z=Q[1],$=t.useState(!1),ee=$[0],te=$[1],ne=t.useState(!1),re=ne[0],ae=ne[1],ie=t.useState(!1),oe=ie[0],ce=ie[1],le=c+"__captions",ue=c+"__time-indicator",se=c+"__duration-indicator",de=c+"__track-list",fe=c+"__subtitle-menu",me=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=!1),"number"!=typeof e?"":y.useHoursInTimestamps&&(t&&e>=3600||C>=3600)?function(e){var t=parseInt(e,10);if(isNaN(t))return"";var n=Math.floor(t/3600),r=Math.floor((t-3600*n)/60),a=t-3600*n-60*r;return h(n)+":"+h(r)+":"+h(a)}(e.toString()):function(e){var t=parseInt(e,10);if(isNaN(t))return"";var n=Math.floor(t/60),r=t-60*n;return h(n)+":"+h(r)}(e.toString())};t.useEffect((function(){k.current.setAttribute("playsinline","playsinline")}),[]),t.useEffect((function(){F(r),D(0)}),[r]);var ve=X>0,pe=X<O.length-1;t.useEffect((function(){k.current.load(),k.current.currentTime=0,V(0)}),[X]);var ge=function(e){B(!1),K(!1),ce(!1),D(e)},Ee=function(e){return e.transcriptUrl&&e.transcriptUrl.length>0},he=function(){return oe?k.current.textTracks:[]},be=O&&O.length&&oe,ye=function(e){ae(!1),Z(e&&e.length?e:null)},Te=function(){if(be){var e=!1;k.current.paused?(k.current.play(),e=!0):k.current.pause(),B(e),M(k.current.currentTime),u&&u.emit("state.playing",e)}},Ne=function(){pe&&ge(X+1)},ke=function(){be&&(k.current.currentTime-=y.rewindTime||5)},Se=function(){be&&(k.current.currentTime+=y.fastForwardTime||5)},_e=function(){k.current.currentTime=0,K(!1),M(k.current.currentTime),V(0),u&&u.emit("state.ended",!1)};t.useEffect((function(){var e;for(e=0;e<k.current.textTracks.length;e+=1)k.current.textTracks[e].mode=k.current.textTracks[e].language===Y?"showing":"hidden"}),[Y]);var we=function(e){"backward"===e?ke():"play_pause"===e?Te():"reset"===e?_e():"forward"===e&&Se()};t.useEffect((function(){return u&&u.on("remote.action",we),function(){u&&u.off("remote.action",we)}}),[]);var Ce=O[X]||null;return t.createElement("div",{className:a("video-wrapper",l)},t.createElement("audio",{className:a("video-element",l),"data-oh-audio-player":"1",crossOrigin:s,preload:"metadata",ref:k,onLoadedMetadata:function(){ce(!0),ye(Y),j(k.current.duration)},onEnded:function(){v?pe&&(Ne(),setTimeout((function(){return Te()}),500)):(K(!0),M(k.current.currentTime),u&&(u.emit("state.playing",!1),u.emit("state.ended",!0)))},onTimeUpdate:function(){C>0&&(V(100/C*k.current.currentTime),M(k.current.currentTime))},"aria-describedby":le},Ce&&t.createElement("source",{src:Ce.audioUrl,type:"audio/mpeg"}),Ce&&Ee(Ce)&&t.createElement("track",{src:Ce.transcriptUrl,kind:"captions",label:"English",srcLang:"en"})),t.createElement("div",{className:a("video-controls",l)},t.createElement(d,{defaultValue:P,className:"video-controls__progress-bar",onClick:function(e){console.log(e),k.current.currentTime=e*C,M(e*C)},useTooltip:y.useTooltip||!1,valueToTooltipString:function(e){return me(k.current?e*k.current.duration:0)}}),t.createElement("label",{className:"sr-only",htmlFor:ue},"Time elapsed"),t.createElement("input",{className:a("video-controls",l,"time-elapsed"),id:ue,readOnly:!0,ref:S,value:me(L)}),y.showDuration&&t.createElement(t.Fragment,null,t.createElement("label",{className:"sr-only",htmlFor:se},"Duration"),t.createElement("input",{className:a("video-controls",l,"duration"),id:se,readOnly:!0,ref:_,value:me(C,!0)})),t.createElement("div",{className:"w-100"}),t.createElement("div",{className:a("video-controls",l,"button-wrapper")},t.createElement(g,{btnType:"tracklist","aria-controls":de,enabled:O.length>0&&!N,onClick:function(){ae(!1),te(!ee)},toggleState:ee,config:y},"Tracklist"),t.createElement("div",{className:a("video-controls",l,"button-wrapper__space")}),t.createElement(i,{btnType:"previous-audio",enabled:O.length>1&&ve,onClick:function(){ve&&ge(X-1)},config:y},"Previous track"),t.createElement(i,{btnType:"backward",onClick:ke,config:y},"Rewind"),t.createElement(g,{btnType:"play",hidden:H,onClick:Te,toggleState:q,config:y},q?"Pause":"Play"),t.createElement(i,{btnType:"reset",enabled:H,hidden:!H,onClick:_e,config:y},"Restart"),t.createElement(i,{btnType:"forward",onClick:Se,config:y},"Fast forward"),t.createElement(i,{btnType:"next-audio",enabled:O.length>1&&pe,onClick:Ne,config:y},"Next track"),t.createElement(g,{btnType:"closed-captioning","aria-controls":fe,enabled:oe&&Ee(Ce),onClick:function(){te(!1),ae(!re)},toggleState:re,config:y},"Closed captioning"),t.createElement("div",{className:a("video-controls",l,"button-wrapper__space")}),t.createElement(g,{btnType:"mute",onClick:function(){var e=!k.current.muted;k.current.muted=e,J(e)},toggleState:G,config:y},"Mute"))),t.createElement(p,{visible:re,id:fe,tracks:he(),selected:Y,onSelect:ye}),t.createElement(E,{visible:!N&&ee,id:de,tracklist:O,selected:X,onSelect:function(e){te(!1),ge(e)}}),t.createElement(f,{visible:null!==Y,lang:Y,tracks:he(),id:le}))};
//# sourceMappingURL=react-ts-media-player.cjs.production.min.js.map
