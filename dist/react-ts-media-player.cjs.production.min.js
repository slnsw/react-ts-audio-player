"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("react")),n=e(require("debounce")),r=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=" "),Array.isArray(e)||(e=[e]),e.join(t)},a=function(e){var n=e.config,a=e.children,i=[].concat(r((void 0===n?{}:n).classNames["sr-only"]));return t.createElement("span",{className:i.join(" ")},a)},i=function(e,t,n,r){return void 0===t&&(t=""),void 0===n&&(n=""),void 0===r&&(r=[]),[].concat(e.split(/\s+/)).concat(t.split(/\s+/)).filter((function(e){return e&&e.length})).map((function(e){return n.length?e+"__"+n:e})).reduce((function(e,t){return e.concat([""].concat(r.filter((function(e){return e&&e.length}))).map((function(e){return t+(e.length?"--"+e:"")})))}),[]).join(" ")},o=function(e){var n=e.enabled,o=void 0===n||n,c=e.hidden,l=void 0!==c&&c,u=e.btnType,s=e.onClick,d=e.children,f=e.className,m=e.config,v=void 0===m?{}:m,p=r(v.classNames[u]),g=r(v.icons[u]),E=v.iconElements[u]||null;return t.createElement("button",{className:i(p,f||""),disabled:!o,hidden:l,onClick:s},t.createElement(a,{config:v},d),!E&&t.createElement("span",{className:i(g,"")}),E)},c=function(e,t,n){return Math.max(t,Math.min(n,e))},l=function(e,t){var n=0,r=t.getBoundingClientRect();return"mousemove"===e.type&&(n=e.pageX-r.left),"touchmove"===e.type&&(n=e.targetTouches[0].pageX-r.left),n},u=function(e){if("number"==typeof e.nativeEvent.offsetX)return e.nativeEvent.offsetX;if("object"==typeof e.targetTouches){var t=e,n=t.target.getBoundingClientRect();return t.targetTouches[0].pageX-n.left}return 0},s=function(e){var n=e.style;return t.createElement("div",{style:void 0===n?{}:n,className:e.className||""},e.title)},d=function(e){var n=e.wrapperClassName,r=e.tooltipClassName,a=e.valueToTooltipString,i=void 0===a?function(){return""}:a,o=e.defaultValue,c=void 0===o?0:o,l=e.show,d=void 0!==l&&l,f=t.useRef(null),m=t.useState(c),v=m[0],p=m[1],g=f.current?f.current.clientWidth:0,E=i(v)||"";return t.createElement("div",{ref:f,onMouseMove:function(e){p(u(e)/g)},className:n},d&&E.length>0&&t.createElement(s,{title:i(v),className:r,style:{left:g*v+"px"}}))},f=function(e){var r=e.defaultValue,a=void 0===r?0:r,o=e.useTooltip,s=void 0!==o&&o,f=e.useRange,m=void 0!==f&&f,v=e.useProgress,p=void 0!==v&&v,g=e.valueToTooltipString,E=void 0===g?function(){return""}:g,b=e.id,h=e.className,y=e.label,T=e.onClick,N=t.useRef(null),_=t.useRef(!1),k=t.useState(!1),S=k[0],w=k[1],C=t.useState(c(a,0,1)),x=C[0],L=C[1],M=t.useState(0),R=M[0],F=M[1],j=t.useState(0),D=j[0],O=j[1],P=b||"scrub-bar",U="function"==typeof T?n(T,250):function(){},A=function(e){_.current=!0,F(u(e))},X=function(){_.current&&(_.current=!1,O((new Date).getTime()))},B=function(e){_.current&&F(l(e,N.current))},I=function(e){_.current&&F(l(e,N.current))};return t.useEffect((function(){return document.addEventListener("mousemove",B,!1),document.addEventListener("touchmove",I,!1),document.addEventListener("mouseup",X,!1),document.addEventListener("touchend",X,!1),function(){document.removeEventListener("mousemove",B,!1),document.removeEventListener("touchmove",I,!1),document.removeEventListener("mouseup",X,!1),document.removeEventListener("touchend",X,!1)}}),[]),t.useEffect((function(){L(c(a,0,100))}),[a]),t.useEffect((function(){if(_.current){var e=c(R/N.current.clientWidth,0,1);L(100*e),U(e)}}),[D,R]),t.createElement("div",{className:i(h||"","","",[_.current?"scrubbing":""]),onMouseOver:function(){return w(!0)},onMouseLeave:function(){return w(!1)},onMouseDown:m?function(){}:A,onTouchStart:m?function(){}:A,ref:N},s&&t.createElement(d,{wrapperClassName:h+"__wraptooltip",tooltipClassName:h+"__tooltip",show:S||_.current,valueToTooltipString:E,defaultValue:x}),(p||m)&&t.createElement("label",{htmlFor:m?P+"__scrubrange":P+"__progress"},t.createElement("span",{className:"sr-only"},y||"",x+" percent"),p&&t.createElement("progress",{max:"100",value:x,className:h+"__progress",id:P+"__progress"}),m&&t.createElement("input",{className:h+"__scrubrange",id:P+"__scrubrange",type:"range",min:"0",max:"100",value:x,onMouseDown:A,onTouchStart:A,onChange:function(e){F(parseFloat(e.currentTarget.value)/100*N.current.clientWidth)}})),!m&&t.createElement("div",{className:[h+"__fill"].join(" "),style:{width:x+"%"}},t.createElement("span",{className:"sr-only"},y||"",x+" percent")))},m=function(e){var n,r=e.visible,a=void 0===r||r,i=e.lang,o=e.tracks,c=void 0===o?[]:o,l=e.id,u=e.className,s=t.useState(""),d=s[0],f=s[1],m=t.useState(null),v=m[0],p=m[1],g=function(e){var t,n,r=e.target.activeCues,a="";for(n=0;n<r.length;n+=1)void 0!==(t=r[n]).text&&(a+=t.text);f(a)};return t.useEffect((function(){return v&&v.addEventListener("cuechange",g,!1),function(){v&&v.removeEventListener("cuechange",g,!1)}}),[(n=v,n?[n.kind,n.mode,n.language,n.cues.length].join(","):"")]),t.useEffect((function(){if(i&&i.length&&c&&c.length){var e,t=null;for(e=0;e<c.length;e+=1)if(c[e].language===i){t=c[e];break}p(t)}}),[i,c]),t.createElement("div",{className:[u||"","video-wrapper__subtitle-container"].join(" "),hidden:!a,"aria-hidden":!a,lang:i,id:l,"aria-atomic":"true","aria-live":"polite","aria-relevant":"additions text"},a?d:" ")},v=function(e){var n=e.id,r=e.visible,a=void 0!==r&&r,i=e.children;return t.createElement("ol",{className:["video-wrapper__popup-menu",e.className||""].join(" "),id:n,hidden:!a,"aria-expanded":a},i)},p=function(e){var n=e.selected,r=e.onSelect;return t.createElement("li",null,t.createElement("button",{"data-value":e.value,"data-state":void 0!==n&&n?"active":"inactive",onClick:r,onKeyUp:function(e){"Enter"===e.key&&r(e)}},e.label))},g=function(e){var n,r,a=e.visible,i=void 0!==a&&a,o=e.id,c=e.tracks,l=e.selected,u=e.onSelect,s=e.className,d=function(e){var t=e.target.getAttribute("data-value")||null;"function"==typeof u&&u(t)},f=[t.createElement(p,{key:"_none_",label:"Off",value:null,selected:!l,onSelect:d})];if(c&&c.length)for(r=0;r<c.length;r+=1)f.push(t.createElement(p,{key:(n=c[r]).language+"-"+r,label:n.label,value:n.language,selected:l&&n.language===l,onSelect:d}));return t.createElement(v,{className:[s||"","subtitles-menu"].join(" "),id:o,visible:i},f)},E=function(e){var n=e.enabled,o=void 0===n||n,c=e.hidden,l=void 0!==c&&c,u=e.btnType,s=e.toggleState,d=void 0!==s&&s,f=e.children,m=e.onClick,v=e.className,p=e.config,g=void 0===p?{}:p,E=r(g.classNames[u]),b=r(g.icons[u+"__false"]),h=r(g.icons[u+"__true"]),y=g.iconElements[u+"__false"]||null,T=g.iconElements[u+"__true"]||null;return t.createElement("button",{className:i(E,v||""),disabled:!o,hidden:l,onClick:m},t.createElement(a,{config:g},f),!d&&!y&&t.createElement("span",{className:i(b)}),!d&&y,d&&!T&&t.createElement("span",{className:i(h)}),d&&T)},b=function(e){var n=e.tracklist,r=e.selected,a=void 0===r?0:r,i=e.visible,o=void 0!==i&&i,c=e.onSelect,l=e.id,u=e.className,s=function(e){var t=e.target.getAttribute("data-value")||null;if(null!==t){var n=parseInt(t,10);"function"==typeof c&&c(n)}},d=(void 0===n?[]:n).map((function(e,n){return t.createElement(p,{key:n,label:e.label,value:n,selected:n===a,onSelect:s})}));return t.createElement(v,{className:[u||"","track-menu"].join(" "),id:l,visible:o},d)},h=function(e){return e<10?"0"+e:e.toString()};exports.default=function(e){var n=e.playlist,r=void 0===n?[]:n,a=e.id,c=void 0===a?"audio-player":a,l=e.className,u=e.eventRouter,s=e.crossOrigin,d=e.onEndNextFile,v=void 0!==d&&d,p=e.config,y=void 0===p?{}:p,T=e.singleTrack,N=void 0!==T&&T,_=e.useRangeOnScrubBar,k=void 0!==_&&_,S=e.useProgressOnScrubBar,w=void 0!==S&&S,C=e.onLoad,x=e.onPlay,L=e.onPause,M=e.onEnd,R=e.onTimeUpdate,F=t.useRef(null),j=t.useRef(null),D=t.useRef(null),O=t.useState(0),P=O[0],U=O[1],A=t.useState(0),X=A[0],B=A[1],I=t.useState([]),V=I[0],W=I[1],q=t.useState(0),H=q[0],K=q[1],z=t.useState(0),G=z[0],J=z[1],Q=t.useState(!1),Y=Q[0],Z=Q[1],$=t.useState(!1),ee=$[0],te=$[1],ne=t.useState(!1),re=ne[0],ae=ne[1],ie=t.useState(null),oe=ie[0],ce=ie[1],le=t.useState(!1),ue=le[0],se=le[1],de=t.useState(!1),fe=de[0],me=de[1],ve=t.useState(!1),pe=ve[0],ge=ve[1],Ee=c+"__captions",be=c+"__time-indicator",he=c+"__duration-indicator",ye=c+"__track-list",Te=c+"__subtitle-menu",Ne=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=!1),"number"!=typeof e?"":y.useHoursInTimestamps&&(t&&e>=3600||P>=3600)?function(e){var t=parseInt(e,10);if(isNaN(t))return"";var n=Math.floor(t/3600),r=Math.floor((t-3600*n)/60),a=t-3600*n-60*r;return h(n)+":"+h(r)+":"+h(a)}(e.toString()):function(e){var t=parseInt(e,10);if(isNaN(t))return"";var n=Math.floor(t/60),r=t-60*n;return h(n)+":"+h(r)}(e.toString())};t.useEffect((function(){F.current.setAttribute("playsinline","playsinline")}),[]),t.useEffect((function(){W(r),K(0)}),[r]);var _e=H>0,ke=H<V.length-1;t.useEffect((function(){F.current.load(),F.current.currentTime=0,J(0)}),[H]);var Se=function(e){Z(!1),te(!1),ge(!1),K(e),"function"==typeof C&&C({fileData:V,selectedFile:e,duration:P})},we=function(e){return e.transcriptUrl&&e.transcriptUrl.length>0},Ce=function(){return pe?F.current.textTracks:[]},xe=V&&V.length&&pe,Le=function(e){me(!1),ce(e&&e.length?e:null)},Me=function(){if(xe){var e=!1;F.current.paused?(F.current.play(),e=!0):F.current.pause();var t=F.current.currentTime;Z(e),B(t),u&&u.emit("state.playing",e),e?"function"==typeof x&&x({fileData:V,selectedFile:H,currentTime:t,duration:P}):"function"==typeof L&&L({fileData:V,selectedFile:H,currentTime:t,duration:P})}},Re=function(){ke&&Se(H+1)},Fe=function(){xe&&(F.current.currentTime-=y.rewindTime||5)},je=function(){xe&&(F.current.currentTime+=y.fastForwardTime||5)},De=function(){F.current.currentTime=0,te(!1),B(F.current.currentTime),J(0),u&&u.emit("state.ended",!1)};t.useEffect((function(){var e;for(e=0;e<F.current.textTracks.length;e+=1)F.current.textTracks[e].mode=F.current.textTracks[e].language===oe?"showing":"hidden"}),[oe]);var Oe=function(e){"backward"===e?Fe():"play_pause"===e?Me():"reset"===e?De():"forward"===e&&je()};t.useEffect((function(){return u&&u.on("remote.action",Oe),function(){u&&u.off("remote.action",Oe)}}),[]);var Pe=V[H]||null;return t.createElement("div",{className:i("video-wrapper",l)},t.createElement("audio",{className:i("video-element",l),"data-oh-audio-player":"1",crossOrigin:s,preload:"metadata",ref:F,onLoadedMetadata:function(){ge(!0),Le(oe),U(F.current.duration)},onEnded:function(){if(v)ke&&(Re(),setTimeout((function(){return Me()}),500));else{te(!0);var e=F.current.currentTime;B(e),u&&(u.emit("state.playing",!1),u.emit("state.ended",!0)),"function"==typeof M&&M({fileData:V,selectedFile:H,currentTime:e,duration:P})}},onTimeUpdate:function(){var e=F.current.currentTime;P>0&&(J(100/P*e),B(e)),"function"==typeof R&&R({fileData:V,selectedFile:H,currentTime:e,duration:P})},"aria-describedby":Ee},Pe&&t.createElement("source",{src:Pe.audioUrl,type:"audio/mpeg"}),Pe&&we(Pe)&&t.createElement("track",{src:Pe.transcriptUrl,kind:"captions",label:"English",srcLang:"en"})),t.createElement("div",{className:i("video-controls",l)},t.createElement(f,{defaultValue:G,className:i("video-controls",l,"progress-bar"),onClick:function(e){F.current.currentTime=e*P,B(e*P)},useTooltip:y.useTooltip||!1,useRange:k,useProgress:w,valueToTooltipString:function(e){return Ne(F.current?e*F.current.duration:0)}}),t.createElement("label",{className:"sr-only",htmlFor:be},"Time elapsed"),t.createElement("input",{className:i("video-controls",l,"time-elapsed"),id:be,readOnly:!0,ref:j,value:Ne(X)}),y.showDuration&&t.createElement(t.Fragment,null,t.createElement("label",{className:"sr-only",htmlFor:he},"Duration"),t.createElement("input",{className:i("video-controls",l,"duration"),id:he,readOnly:!0,ref:D,value:Ne(P,!0)})),t.createElement("div",{className:"w-100"}),t.createElement("div",{className:i("video-controls",l,"button-wrapper")},t.createElement(E,{btnType:"tracklist","aria-controls":ye,enabled:V.length>0&&!N,onClick:function(){me(!1),se(!ue)},toggleState:ue,config:y},"Tracklist"),t.createElement("div",{className:i("video-controls",l,"button-wrapper__space")}),t.createElement(o,{btnType:"previous-audio",enabled:V.length>1&&_e,onClick:function(){_e&&Se(H-1)},config:y},"Previous track"),t.createElement(o,{btnType:"backward",onClick:Fe,config:y},"Rewind"),t.createElement(E,{btnType:"play",hidden:ee,onClick:Me,toggleState:Y,config:y},Y?"Pause":"Play"),t.createElement(o,{btnType:"reset",enabled:ee,hidden:!ee,onClick:De,config:y},"Restart"),t.createElement(o,{btnType:"forward",onClick:je,config:y},"Fast forward"),t.createElement(o,{btnType:"next-audio",enabled:V.length>1&&ke,onClick:Re,config:y},"Next track"),t.createElement(E,{btnType:"closed-captioning","aria-controls":Te,enabled:pe&&we(Pe),onClick:function(){se(!1),me(!fe)},toggleState:fe,config:y},"Closed captioning"),t.createElement("div",{className:i("video-controls",l,"button-wrapper__space")}),t.createElement(E,{btnType:"mute",onClick:function(){var e=!F.current.muted;F.current.muted=e,ae(e)},toggleState:re,config:y},"Mute"))),t.createElement(g,{visible:fe,id:Te,tracks:Ce(),selected:oe,onSelect:Le}),t.createElement(b,{visible:!N&&ue,id:ye,tracklist:V,selected:H,onSelect:function(e){se(!1),Se(e)}}),t.createElement(m,{visible:null!==oe,lang:oe,tracks:Ce(),id:Ee}))};
//# sourceMappingURL=react-ts-media-player.cjs.production.min.js.map
