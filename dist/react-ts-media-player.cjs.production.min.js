"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("react")),n=e(require("debounce")),r=function(e){var n=e.config,r=e.children,a=[].concat((void 0===n?{}:n).classNames["sr-only"]||[]);return t.createElement("span",{className:a.join(" ")},r)},a=function(e,t,n,r){return void 0===t&&(t=""),void 0===n&&(n=""),void 0===r&&(r=[]),[].concat(e.split(/\s+/)).concat(t.split(/\s+/)).filter((function(e){return e&&e.length})).map((function(e){return n.length?e+"__"+n:e})).reduce((function(e,t){return e.concat([""].concat(r.filter((function(e){return e&&e.length}))).map((function(e){return t+(e.length?"--"+e:"")})))}),[]).join(" ")},i=function(e){var n=e.enabled,i=void 0===n||n,o=e.hidden,c=void 0!==o&&o,l=e.btnType,u=e.onClick,s=e.children,d=e.className,m=e.config,f=void 0===m?{}:m,v=(f.classNames[l]||[]).join(" "),p=(f.icons[l]||[]).join(" "),g=f.iconElements[l]||null;return t.createElement("button",{className:a(v,d||""),disabled:!i,hidden:c,onClick:u},t.createElement(r,{config:f},s),!g&&t.createElement("span",{className:a(p,"")}),g)},o=function(e,t,n){return Math.max(t,Math.min(n,e))},c=function(e,t){var n=0,r=t.getBoundingClientRect();return"mousemove"===e.type&&(n=e.pageX-r.left),"touchmove"===e.type&&(n=e.targetTouches[0].pageX-r.left),n},l=function(e){if("number"==typeof e.nativeEvent.offsetX)return e.nativeEvent.offsetX;if("object"==typeof e.targetTouches){var t=e,n=t.target.getBoundingClientRect();return t.targetTouches[0].pageX-n.left}return 0},u=function(e){var n=e.style;return t.createElement("div",{style:void 0===n?{}:n,className:e.className||""},e.title)},s=function(e){var n=e.wrapperClassName,r=e.tooltipClassName,a=e.valueToTooltipString,i=void 0===a?function(){return""}:a,o=e.defaultValue,c=void 0===o?0:o,s=e.show,d=void 0!==s&&s,m=t.useRef(null),f=t.useState(c),v=f[0],p=f[1],g=m.current?m.current.clientWidth:0,E=i(v)||"";return t.createElement("div",{ref:m,onMouseMove:function(e){p(l(e)/g)},className:n},d&&E.length>0&&t.createElement(u,{title:i(v),className:r,style:{left:g*v+"px"}}))},d=function(e){var r=e.defaultValue,i=void 0===r?0:r,u=e.useTooltip,d=void 0!==u&&u,m=e.useRange,f=void 0!==m&&m,v=e.useProgress,p=void 0!==v&&v,g=e.valueToTooltipString,E=void 0===g?function(){return""}:g,b=e.id,h=e.className,N=e.label,y=e.onClick,T=t.useRef(null),_=t.useRef(!1),k=t.useState(!1),S=k[0],w=k[1],C=t.useState(o(i,0,1)),x=C[0],j=C[1],M=t.useState(0),R=M[0],L=M[1],O=t.useState(0),F=O[0],P=O[1],U=b||"scrub-bar",D="function"==typeof y?n(y,250):function(){},X=function(e){_.current=!0,L(l(e))},B=function(){_.current&&(_.current=!1,P((new Date).getTime()))},I=function(e){_.current&&L(c(e,T.current))},V=function(e){_.current&&L(c(e,T.current))};return t.useEffect((function(){return document.addEventListener("mousemove",I,!1),document.addEventListener("touchmove",V,!1),document.addEventListener("mouseup",B,!1),document.addEventListener("touchend",B,!1),function(){document.removeEventListener("mousemove",I,!1),document.removeEventListener("touchmove",V,!1),document.removeEventListener("mouseup",B,!1),document.removeEventListener("touchend",B,!1)}}),[]),t.useEffect((function(){j(o(i,0,100))}),[i]),t.useEffect((function(){if(_.current){var e=o(R/T.current.clientWidth,0,1);j(100*e),D(e)}}),[F,R]),t.createElement("div",{className:a(h||"","","",[_.current?"scrubbing":""]),onMouseOver:function(){return w(!0)},onMouseLeave:function(){return w(!1)},onMouseDown:f?function(){}:X,onTouchStart:f?function(){}:X,ref:T},d&&t.createElement(s,{wrapperClassName:h+"__wraptooltip",tooltipClassName:h+"__tooltip",show:S||_.current,valueToTooltipString:E,defaultValue:x}),(p||f)&&t.createElement("label",{htmlFor:f?U+"__scrubrange":U+"__progress"},t.createElement("span",{className:"sr-only"},N||"",x+" percent"),p&&t.createElement("progress",{max:"100",value:x,className:h+"__progress",id:U+"__progress"}),f&&t.createElement("input",{className:h+"__scrubrange",id:U+"__scrubrange",type:"range",min:"0",max:"100",value:x,onMouseDown:X,onTouchStart:X,onChange:function(e){L(parseFloat(e.currentTarget.value)/100*T.current.clientWidth)}})),!f&&t.createElement("div",{className:[h+"__fill"].join(" "),style:{width:x+"%"}},t.createElement("span",{className:"sr-only"},N||"",x+" percent")))},m=function(e){var n,r=e.visible,a=void 0===r||r,i=e.lang,o=e.tracks,c=void 0===o?[]:o,l=e.id,u=e.className,s=t.useState(""),d=s[0],m=s[1],f=t.useState(null),v=f[0],p=f[1],g=function(e){var t,n,r=e.target.activeCues,a="";for(n=0;n<r.length;n+=1)void 0!==(t=r[n]).text&&(a+=t.text);m(a)};return t.useEffect((function(){return v&&v.addEventListener("cuechange",g,!1),function(){v&&v.removeEventListener("cuechange",g,!1)}}),[(n=v,n?[n.kind,n.mode,n.language,n.cues.length].join(","):"")]),t.useEffect((function(){if(i&&i.length&&c&&c.length){var e,t=null;for(e=0;e<c.length;e+=1)if(c[e].language===i){t=c[e];break}p(t)}}),[i,c]),t.createElement("div",{className:[u||"","video-wrapper__subtitle-container"].join(" "),hidden:!a,"aria-hidden":!a,lang:i,id:l,"aria-atomic":"true","aria-live":"polite","aria-relevant":"additions text"},a?d:" ")},f=function(e){var n=e.id,r=e.visible,a=void 0!==r&&r,i=e.children;return t.createElement("ol",{className:["video-wrapper__popup-menu",e.className||""].join(" "),id:n,hidden:!a,"aria-expanded":a},i)},v=function(e){var n=e.selected,r=e.onSelect;return t.createElement("li",null,t.createElement("button",{"data-value":e.value,"data-state":void 0!==n&&n?"active":"inactive",onClick:r,onKeyUp:function(e){"Enter"===e.key&&r(e)}},e.label))},p=function(e){var n,r,a=e.visible,i=void 0!==a&&a,o=e.id,c=e.tracks,l=e.selected,u=e.onSelect,s=e.className,d=function(e){var t=e.target.getAttribute("data-value")||null;"function"==typeof u&&u(t)},m=[t.createElement(v,{key:"_none_",label:"Off",value:null,selected:!l,onSelect:d})];if(c&&c.length)for(r=0;r<c.length;r+=1)m.push(t.createElement(v,{key:(n=c[r]).language+"-"+r,label:n.label,value:n.language,selected:l&&n.language===l,onSelect:d}));return t.createElement(f,{className:[s||"","subtitles-menu"].join(" "),id:o,visible:i},m)},g=function(e){var n=e.enabled,i=void 0===n||n,o=e.hidden,c=void 0!==o&&o,l=e.btnType,u=e.toggleState,s=void 0!==u&&u,d=e.children,m=e.onClick,f=e.className,v=e.config,p=void 0===v?{}:v,g=(p.classNames[l]||[]).join(" "),E=(p.icons[l+"__false"]||[]).join(" "),b=(p.icons[l+"__true"]||[]).join(" "),h=p.iconElements[l+"__false"]||null,N=p.iconElements[l+"__true"]||null;return t.createElement("button",{className:a(g,f||""),disabled:!i,hidden:c,onClick:m},t.createElement(r,{config:p},d),!s&&!h&&t.createElement("span",{className:a(E)}),!s&&h,s&&!N&&t.createElement("span",{className:a(b)}),s&&N)},E=function(e){var n=e.tracklist,r=e.selected,a=void 0===r?0:r,i=e.visible,o=void 0!==i&&i,c=e.onSelect,l=e.id,u=e.className,s=function(e){var t=e.target.getAttribute("data-value")||null;if(null!==t){var n=parseInt(t,10);"function"==typeof c&&c(n)}},d=(void 0===n?[]:n).map((function(e,n){return t.createElement(v,{key:n,label:e.label,value:n,selected:n===a,onSelect:s})}));return t.createElement(f,{className:[u||"","track-menu"].join(" "),id:l,visible:o},d)},b=function(e){return e<10?"0"+e:e.toString()};exports.default=function(e){var n=e.playlist,r=void 0===n?[]:n,o=e.id,c=void 0===o?"audio-player":o,l=e.className,u=e.eventRouter,s=e.crossOrigin,f=e.onEndNextFile,v=void 0!==f&&f,h=e.config,N=void 0===h?{}:h,y=e.singleTrack,T=void 0!==y&&y,_=e.useRangeOnScrubBar,k=void 0!==_&&_,S=e.useProgressOnScrubBar,w=void 0!==S&&S,C=t.useRef(null),x=t.useRef(null),j=t.useRef(null),M=t.useState(0),R=M[0],L=M[1],O=t.useState(0),F=O[0],P=O[1],U=t.useState([]),D=U[0],X=U[1],B=t.useState(0),I=B[0],V=B[1],A=t.useState(0),W=A[0],q=A[1],H=t.useState(!1),K=H[0],z=H[1],G=t.useState(!1),J=G[0],Q=G[1],Y=t.useState(!1),Z=Y[0],$=Y[1],ee=t.useState(null),te=ee[0],ne=ee[1],re=t.useState(!1),ae=re[0],ie=re[1],oe=t.useState(!1),ce=oe[0],le=oe[1],ue=t.useState(!1),se=ue[0],de=ue[1],me=c+"__captions",fe=c+"__time-indicator",ve=c+"__duration-indicator",pe=c+"__track-list",ge=c+"__subtitle-menu",Ee=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=!1),"number"!=typeof e?"":N.useHoursInTimestamps&&(t&&e>=3600||R>=3600)?function(e){var t=parseInt(e,10);if(isNaN(t))return"";var n=Math.floor(t/3600),r=Math.floor((t-3600*n)/60),a=t-3600*n-60*r;return b(n)+":"+b(r)+":"+b(a)}(e.toString()):function(e){var t=parseInt(e,10);if(isNaN(t))return"";var n=Math.floor(t/60),r=t-60*n;return b(n)+":"+b(r)}(e.toString())};t.useEffect((function(){C.current.setAttribute("playsinline","playsinline")}),[]),t.useEffect((function(){X(r),V(0)}),[r]);var be=I>0,he=I<D.length-1;t.useEffect((function(){C.current.load(),C.current.currentTime=0,q(0)}),[I]);var Ne=function(e){z(!1),Q(!1),de(!1),V(e)},ye=function(e){return e.transcriptUrl&&e.transcriptUrl.length>0},Te=function(){return se?C.current.textTracks:[]},_e=D&&D.length&&se,ke=function(e){le(!1),ne(e&&e.length?e:null)},Se=function(){if(_e){var e=!1;C.current.paused?(C.current.play(),e=!0):C.current.pause(),z(e),P(C.current.currentTime),u&&u.emit("state.playing",e)}},we=function(){he&&Ne(I+1)},Ce=function(){_e&&(C.current.currentTime-=N.rewindTime||5)},xe=function(){_e&&(C.current.currentTime+=N.fastForwardTime||5)},je=function(){C.current.currentTime=0,Q(!1),P(C.current.currentTime),q(0),u&&u.emit("state.ended",!1)};t.useEffect((function(){var e;for(e=0;e<C.current.textTracks.length;e+=1)C.current.textTracks[e].mode=C.current.textTracks[e].language===te?"showing":"hidden"}),[te]);var Me=function(e){"backward"===e?Ce():"play_pause"===e?Se():"reset"===e?je():"forward"===e&&xe()};t.useEffect((function(){return u&&u.on("remote.action",Me),function(){u&&u.off("remote.action",Me)}}),[]);var Re=D[I]||null;return t.createElement("div",{className:a("video-wrapper",l)},t.createElement("audio",{className:a("video-element",l),"data-oh-audio-player":"1",crossOrigin:s,preload:"metadata",ref:C,onLoadedMetadata:function(){de(!0),ke(te),L(C.current.duration)},onEnded:function(){v?he&&(we(),setTimeout((function(){return Se()}),500)):(Q(!0),P(C.current.currentTime),u&&(u.emit("state.playing",!1),u.emit("state.ended",!0)))},onTimeUpdate:function(){R>0&&(q(100/R*C.current.currentTime),P(C.current.currentTime))},"aria-describedby":me},Re&&t.createElement("source",{src:Re.audioUrl,type:"audio/mpeg"}),Re&&ye(Re)&&t.createElement("track",{src:Re.transcriptUrl,kind:"captions",label:"English",srcLang:"en"})),t.createElement("div",{className:a("video-controls",l)},t.createElement(d,{defaultValue:W,className:a("video-controls",l,"progress-bar"),onClick:function(e){C.current.currentTime=e*R,P(e*R)},useTooltip:N.useTooltip||!1,useRange:k,useProgress:w,valueToTooltipString:function(e){return Ee(C.current?e*C.current.duration:0)}}),t.createElement("label",{className:"sr-only",htmlFor:fe},"Time elapsed"),t.createElement("input",{className:a("video-controls",l,"time-elapsed"),id:fe,readOnly:!0,ref:x,value:Ee(F)}),N.showDuration&&t.createElement(t.Fragment,null,t.createElement("label",{className:"sr-only",htmlFor:ve},"Duration"),t.createElement("input",{className:a("video-controls",l,"duration"),id:ve,readOnly:!0,ref:j,value:Ee(R,!0)})),t.createElement("div",{className:"w-100"}),t.createElement("div",{className:a("video-controls",l,"button-wrapper")},t.createElement(g,{btnType:"tracklist","aria-controls":pe,enabled:D.length>0&&!T,onClick:function(){le(!1),ie(!ae)},toggleState:ae,config:N},"Tracklist"),t.createElement("div",{className:a("video-controls",l,"button-wrapper__space")}),t.createElement(i,{btnType:"previous-audio",enabled:D.length>1&&be,onClick:function(){be&&Ne(I-1)},config:N},"Previous track"),t.createElement(i,{btnType:"backward",onClick:Ce,config:N},"Rewind"),t.createElement(g,{btnType:"play",hidden:J,onClick:Se,toggleState:K,config:N},K?"Pause":"Play"),t.createElement(i,{btnType:"reset",enabled:J,hidden:!J,onClick:je,config:N},"Restart"),t.createElement(i,{btnType:"forward",onClick:xe,config:N},"Fast forward"),t.createElement(i,{btnType:"next-audio",enabled:D.length>1&&he,onClick:we,config:N},"Next track"),t.createElement(g,{btnType:"closed-captioning","aria-controls":ge,enabled:se&&ye(Re),onClick:function(){ie(!1),le(!ce)},toggleState:ce,config:N},"Closed captioning"),t.createElement("div",{className:a("video-controls",l,"button-wrapper__space")}),t.createElement(g,{btnType:"mute",onClick:function(){var e=!C.current.muted;C.current.muted=e,$(e)},toggleState:Z,config:N},"Mute"))),t.createElement(p,{visible:ce,id:ge,tracks:Te(),selected:te,onSelect:ke}),t.createElement(E,{visible:!T&&ae,id:pe,tracklist:D,selected:I,onSelect:function(e){ie(!1),Ne(e)}}),t.createElement(m,{visible:null!==te,lang:te,tracks:Te(),id:me}))};
//# sourceMappingURL=react-ts-media-player.cjs.production.min.js.map
