{"version":3,"file":"react-ts-media-player.esm.js","sources":["../src/SrOnly.tsx","../src/Util/CssClasses.ts","../src/ActionButton.tsx","../src/Util/Numbers.ts","../src/ScrubBar.tsx","../src/SubtitleContainer.tsx","../src/Menu.tsx","../src/MenuItem.tsx","../src/SubtitleMenu.tsx","../src/ToggleButton.tsx","../src/TracklistMenu.tsx","../src/TimeUtils.ts","../src/AudioPlayer.tsx"],"sourcesContent":["// @file\r\n// Screenreader only wrapper.\r\n\r\nimport React from 'react';\r\n\r\nimport { IAudioPlayerConfig } from './Types';\r\n\r\ninterface IProps {\r\n  children?: React.ReactNode;\r\n  config?: IAudioPlayerConfig;\r\n}\r\n\r\nconst SrOnly: React.FunctionComponent<IProps> = ({ config = {}, children }) => {\r\n  const classNames = [].concat(config.classNames['sr-only'] || []);\r\n  return <span className={classNames.join(' ')}>{children}</span>;\r\n};\r\n\r\nexport default SrOnly;\r\n","// @file\r\n// Generate BEM-scoped CSS classes.\r\n\r\nconst CssClasses = (\r\n  defaultClassName: string,\r\n  optionalClassName: string = '',\r\n  suffix: string = '',\r\n  states: any[] = [],\r\n): string => {\r\n  const classes = []\r\n    .concat(defaultClassName.split(/\\s+/))\r\n    .concat(optionalClassName.split(/\\s+/))\r\n    .filter((c) => c && c.length)\r\n    .map((c) => (suffix.length ? `${c}__${suffix}` : c));\r\n\r\n  return classes\r\n    .reduce(\r\n      (agg, className) =>\r\n        agg.concat(\r\n          ['']\r\n            .concat(states.filter((s) => s && s.length))\r\n            .map((state) => `${className}${state.length ? `--${state}` : ''}`),\r\n        ),\r\n      [],\r\n    )\r\n    .join(' ');\r\n};\r\n\r\nexport default CssClasses;\r\n","// @file\r\n// Functional component for an action button.\r\n\r\nimport React from 'react';\r\n\r\nimport SrOnly from './SrOnly';\r\nimport CssClasses from './Util/CssClasses';\r\n\r\nimport { IAudioPlayerConfig } from './Types';\r\n\r\ninterface IProps {\r\n  btnType: string;\r\n  enabled?: boolean;\r\n  hidden?: boolean;\r\n  onClick?: (e: React.MouseEvent) => void;\r\n  children?: React.ReactNode;\r\n  className?: string;\r\n  config?: IAudioPlayerConfig;\r\n}\r\n\r\nconst ActionButton: React.FunctionComponent<IProps> = ({\r\n  enabled = true,\r\n  hidden = false,\r\n  btnType,\r\n  onClick,\r\n  children,\r\n  className,\r\n  config = {},\r\n}) => {\r\n  const defaultClassName = (config.classNames[btnType] || []).join(' ');\r\n  const iconClassNames = (config.icons[btnType] || []).join(' ');\r\n  const iconElem = config.iconElements[btnType] || null;\r\n  return (\r\n    <button\r\n      className={CssClasses(defaultClassName, className || '')}\r\n      disabled={!enabled}\r\n      hidden={hidden}\r\n      onClick={onClick}\r\n    >\r\n      <SrOnly config={config}>{children}</SrOnly>\r\n      {!iconElem && <span className={CssClasses(iconClassNames, '')}></span>}\r\n      {iconElem}\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default ActionButton;\r\n","export const clampNumber = (num: number, min: number, max: number): number =>\r\n  Math.max(min, Math.min(max, num));\r\n","// @file\r\n// Functional component for an action button.\r\n\r\nimport React from 'react';\r\nimport debounce from 'debounce';\r\n\r\nimport CssClasses from './Util/CssClasses';\r\nimport { clampNumber } from './Util/Numbers';\r\n\r\n/**\r\n * Note: defaultValue is between 0 and 100.\r\n */\r\ninterface IProps {\r\n  defaultValue: number;\r\n  className?: string;\r\n  id?: string;\r\n  label?: string;\r\n  onClick?: (pos: number) => void;\r\n  useTooltip?: boolean;\r\n  useRange?: boolean;\r\n  useProgress?: boolean;\r\n  valueToTooltipString?: (pos: number) => string;\r\n}\r\n\r\nconst getOffsetXNative = (\r\n  e: MouseEvent | TouchEvent,\r\n  container: HTMLDivElement,\r\n) => {\r\n  let offsetX = 0;\r\n  const rect = container.getBoundingClientRect();\r\n  if (e.type === 'mousemove') {\r\n    offsetX = (e as MouseEvent).pageX - rect.left;\r\n  }\r\n  if (e.type === 'touchmove') {\r\n    offsetX = (e as TouchEvent).targetTouches[0].pageX - rect.left;\r\n  }\r\n  return offsetX;\r\n};\r\n\r\nconst getOffsetX = (e: React.TouchEvent | React.MouseEvent) => {\r\n  if (typeof (e as React.MouseEvent).nativeEvent.offsetX === 'number') {\r\n    return (e as React.MouseEvent).nativeEvent.offsetX;\r\n  }\r\n  if (typeof (e as React.TouchEvent).targetTouches === 'object') {\r\n    const touchE = e as React.TouchEvent;\r\n    const rect = (touchE.target as HTMLDivElement).getBoundingClientRect();\r\n    return touchE.targetTouches[0].pageX - rect.left;\r\n  }\r\n  return 0;\r\n};\r\n\r\nconst ON_CLICK_DEBOUNCE = 250;\r\n\r\ninterface ITooltipProps {\r\n  title?: string;\r\n  className?: string;\r\n  style?: any;\r\n}\r\n\r\nconst ScrubBarTooltip: React.FunctionComponent<ITooltipProps> = ({\r\n  title,\r\n  className,\r\n  style = {},\r\n}) => {\r\n  return (\r\n    <div style={style} className={className || ''}>\r\n      {title}\r\n    </div>\r\n  );\r\n};\r\n\r\ninterface ITooltipOuterProps {\r\n  wrapperClassName?: string;\r\n  tooltipClassName?: string;\r\n  valueToTooltipString?: (pos: number) => string;\r\n  defaultValue?: number;\r\n  show?: boolean;\r\n}\r\n\r\nconst ScrubBarTooltipOuter: React.FunctionComponent<ITooltipOuterProps> = ({\r\n  wrapperClassName,\r\n  tooltipClassName,\r\n  valueToTooltipString = () => '',\r\n  defaultValue = 0,\r\n  show = false,\r\n}) => {\r\n  const outer = React.useRef(null);\r\n  const [value, setValue] = React.useState(defaultValue);\r\n\r\n  const outerWidth = outer.current ? outer.current.clientWidth : 0;\r\n\r\n  const content = valueToTooltipString(value) || '';\r\n\r\n  return (\r\n    <div\r\n      ref={outer}\r\n      onMouseMove={(e: React.MouseEvent) => {\r\n        setValue(getOffsetX(e) / outerWidth);\r\n      }}\r\n      className={wrapperClassName}\r\n    >\r\n      {show && content.length > 0 && (\r\n        <ScrubBarTooltip\r\n          title={valueToTooltipString(value)}\r\n          className={tooltipClassName}\r\n          style={{\r\n            left: `${outerWidth * value}px`,\r\n          }}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst ScrubBar: React.FunctionComponent<IProps> = ({\r\n  defaultValue = 0,\r\n  useTooltip = false,\r\n  useRange = false,\r\n  useProgress = false,\r\n  valueToTooltipString = () => '',\r\n  id,\r\n  className,\r\n  label,\r\n  onClick,\r\n}: IProps) => {\r\n  const outer = React.useRef(null);\r\n  const scrubbing = React.useRef(false);\r\n\r\n  const [hover, setHover] = React.useState(false);\r\n  const [value, setValue] = React.useState(clampNumber(defaultValue, 0, 1));\r\n  const [offsetX, setOffsetX] = React.useState(0);\r\n  const [lastUpdate, setLastUpdate] = React.useState(0);\r\n\r\n  const derivedId = id || 'scrub-bar';\r\n\r\n  const debouncedOnClick =\r\n    typeof onClick === 'function'\r\n      ? debounce(onClick, ON_CLICK_DEBOUNCE)\r\n      : () => {};\r\n\r\n  const onDown = (e: React.TouchEvent | React.MouseEvent) => {\r\n    scrubbing.current = true;\r\n    setOffsetX(getOffsetX(e));\r\n  };\r\n\r\n  const onUp = () => {\r\n    if (scrubbing.current) {\r\n      scrubbing.current = false;\r\n      setLastUpdate(new Date().getTime());\r\n    }\r\n  };\r\n\r\n  const onMouseMove = (e: MouseEvent) => {\r\n    if (scrubbing.current) {\r\n      setOffsetX(getOffsetXNative(e, outer.current));\r\n    }\r\n  };\r\n\r\n  const onTouchMove = (e: TouchEvent) => {\r\n    if (scrubbing.current) {\r\n      setOffsetX(getOffsetXNative(e, outer.current));\r\n    }\r\n  };\r\n\r\n  // Set up cursor move and cursor up events on the entire document\r\n  // so that the scrub can persist even when the user drags outside\r\n  // the scrub bar.\r\n  React.useEffect(() => {\r\n    document.addEventListener('mousemove', onMouseMove, false);\r\n    document.addEventListener('touchmove', onTouchMove, false);\r\n    document.addEventListener('mouseup', onUp, false);\r\n    document.addEventListener('touchend', onUp, false);\r\n    return () => {\r\n      document.removeEventListener('mousemove', onMouseMove, false);\r\n      document.removeEventListener('touchmove', onTouchMove, false);\r\n      document.removeEventListener('mouseup', onUp, false);\r\n      document.removeEventListener('touchend', onUp, false);\r\n    };\r\n  }, []);\r\n\r\n  // Prop update -- set value, don't propagate.\r\n  React.useEffect(() => {\r\n    setValue(clampNumber(defaultValue, 0, 100));\r\n  }, [defaultValue]);\r\n\r\n  // State update -- set value, propagate back to parent.\r\n  React.useEffect(() => {\r\n    if (scrubbing.current) {\r\n      const pos = clampNumber(offsetX / outer.current.clientWidth, 0, 1);\r\n      setValue(pos * 100);\r\n      debouncedOnClick(pos);\r\n    }\r\n  }, [lastUpdate, offsetX]);\r\n\r\n  return (\r\n    <div\r\n      className={CssClasses(className || '', '', '', [\r\n        scrubbing.current ? 'scrubbing' : '',\r\n      ])}\r\n      onMouseOver={() => setHover(true)}\r\n      onMouseLeave={() => setHover(false)}\r\n      onMouseDown={useRange ? () => {} : onDown}\r\n      onTouchStart={useRange ? () => {} : onDown}\r\n      ref={outer}\r\n    >\r\n      {useTooltip && (\r\n        <ScrubBarTooltipOuter\r\n          wrapperClassName={`${className}__wraptooltip`}\r\n          tooltipClassName={`${className}__tooltip`}\r\n          show={hover || scrubbing.current}\r\n          valueToTooltipString={valueToTooltipString}\r\n          defaultValue={value}\r\n        />\r\n      )}\r\n      {(useProgress || useRange) && (\r\n        <label\r\n          htmlFor={\r\n            useRange ? `${derivedId}__scrubrange` : `${derivedId}__progress`\r\n          }\r\n        >\r\n          <span className=\"sr-only\">\r\n            {label || ''}\r\n            {`${value} percent`}\r\n          </span>\r\n          {useProgress && (\r\n            <progress\r\n              max=\"100\"\r\n              value={value}\r\n              className={`${className}__progress`}\r\n              id={`${derivedId}__progress`}\r\n            />\r\n          )}\r\n          {useRange && (\r\n            <input\r\n              className={`${className}__scrubrange`}\r\n              id={`${derivedId}__scrubrange`}\r\n              type=\"range\"\r\n              min=\"0\"\r\n              max=\"100\"\r\n              value={value}\r\n              onMouseDown={onDown}\r\n              onTouchStart={onDown}\r\n              onChange={(e) => {\r\n                setOffsetX(\r\n                  (parseFloat(e.currentTarget.value) / 100.0) *\r\n                    outer.current.clientWidth,\r\n                );\r\n              }}\r\n            />\r\n          )}\r\n        </label>\r\n      )}\r\n      {!useRange && (\r\n        <div\r\n          className={[`${className}__fill`].join(' ')}\r\n          style={{ width: `${value}%` }}\r\n        >\r\n          <span className=\"sr-only\">\r\n            {label || ''}\r\n            {`${value} percent`}\r\n          </span>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ScrubBar;\r\n","// @file\r\n// Oral Histories subtitle menu.\r\n\r\nimport React from 'react';\r\n\r\nconst memoiseTrack = (track: TextTrack): string => {\r\n  if (!track) {\r\n    return '';\r\n  }\r\n  const { kind, mode, language, cues } = track;\r\n  return [kind, mode, language, cues.length].join(',');\r\n};\r\n\r\ninterface IProps {\r\n  visible?: boolean;\r\n  lang?: string;\r\n  tracks: TextTrack[];\r\n  id: string;\r\n  className?: string;\r\n}\r\n\r\nconst SubtitleContainer: React.FunctionComponent<IProps> = ({\r\n  visible = true,\r\n  lang,\r\n  tracks = [],\r\n  id,\r\n  className,\r\n}: IProps) => {\r\n  const [text, setText] = React.useState('');\r\n  const [currentTrack, setCurrentTrack] = React.useState(null);\r\n\r\n  const cueChange = (e: Event) => {\r\n    const { activeCues } = e.target as TextTrack;\r\n\r\n    let newText = '';\r\n    let cue;\r\n\r\n    let i;\r\n    for (i = 0; i < activeCues.length; i += 1) {\r\n      cue = activeCues[i];\r\n      if (typeof cue.text !== 'undefined') {\r\n        newText += cue.text;\r\n      }\r\n    }\r\n    setText(newText);\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    if (currentTrack) {\r\n      currentTrack.addEventListener('cuechange', cueChange, false);\r\n    }\r\n    return () => {\r\n      if (currentTrack) {\r\n        currentTrack.removeEventListener('cuechange', cueChange, false);\r\n      }\r\n    };\r\n  }, [memoiseTrack(currentTrack)]);\r\n\r\n  React.useEffect(() => {\r\n    if (lang && lang.length && tracks && tracks.length) {\r\n      let track = null;\r\n      let i;\r\n      for (i = 0; i < tracks.length; i += 1) {\r\n        if (tracks[i].language === lang) {\r\n          track = tracks[i];\r\n          break;\r\n        }\r\n      }\r\n      setCurrentTrack(track);\r\n    }\r\n  }, [lang, tracks]);\r\n\r\n  return (\r\n    <div\r\n      className={[className || '', 'video-wrapper__subtitle-container'].join(\r\n        ' ',\r\n      )}\r\n      hidden={!visible}\r\n      aria-hidden={!visible}\r\n      lang={lang}\r\n      id={id}\r\n      aria-atomic=\"true\"\r\n      aria-live=\"polite\"\r\n      aria-relevant=\"additions text\"\r\n    >\r\n      {visible ? text : ' '}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SubtitleContainer;\r\n","// @file\r\n// Menu container.\r\n\r\nimport React from 'react';\r\n\r\ninterface IProps {\r\n  id?: string;\r\n  visible?: boolean;\r\n  className?: string;\r\n  children?: React.ReactNode;\r\n}\r\n\r\nconst Menu: React.FunctionComponent<IProps> = ({\r\n  id,\r\n  visible = false,\r\n  className,\r\n  children,\r\n}: IProps) => {\r\n  return (\r\n    <ol\r\n      className={['video-wrapper__popup-menu', className || ''].join(' ')}\r\n      id={id}\r\n      hidden={!visible}\r\n      aria-expanded={visible}\r\n    >\r\n      {children}\r\n    </ol>\r\n  );\r\n};\r\n\r\nexport default Menu;\r\n","import React from 'react';\r\n\r\ninterface IProps {\r\n  label: string;\r\n  value: string | number | null;\r\n  selected: boolean;\r\n  onSelect: (e: React.KeyboardEvent | React.MouseEvent) => void;\r\n}\r\n\r\nconst MenuItem: React.FunctionComponent<IProps> = ({\r\n  label,\r\n  value,\r\n  selected = false,\r\n  onSelect,\r\n}: IProps) => {\r\n  return (\r\n    <li>\r\n      <button\r\n        data-value={value}\r\n        data-state={selected ? 'active' : 'inactive'}\r\n        onClick={onSelect}\r\n        onKeyUp={(e) => {\r\n          if (e.key === 'Enter') {\r\n            onSelect(e);\r\n          }\r\n        }}\r\n      >\r\n        {label}\r\n      </button>\r\n    </li>\r\n  );\r\n};\r\n\r\nexport default MenuItem;\r\n","// @file\r\n// Oral Histories subtitle menu.\r\n\r\nimport React from 'react';\r\n\r\nimport Menu from './Menu';\r\nimport MenuItem from './MenuItem';\r\n\r\ninterface IProps {\r\n  visible: boolean;\r\n  id: string;\r\n  tracks: TextTrackList;\r\n  selected?: string;\r\n  onSelect: (selectedLang: string) => void;\r\n  className?: string;\r\n}\r\n\r\nconst SubtitleMenu: React.FunctionComponent<IProps> = ({\r\n  visible = false,\r\n  id,\r\n  tracks,\r\n  selected,\r\n  onSelect,\r\n  className,\r\n}: IProps) => {\r\n  const onSelectLang = (e: React.MouseEvent | React.KeyboardEvent) => {\r\n    const itemElem = e.target as HTMLElement;\r\n    const selectedLang = itemElem.getAttribute('data-value') || null;\r\n    if (typeof onSelect === 'function') {\r\n      onSelect(selectedLang);\r\n    }\r\n  };\r\n\r\n  const languageOptions = [\r\n    <MenuItem\r\n      key={'_none_'}\r\n      label={'Off'}\r\n      value={null}\r\n      selected={!selected}\r\n      onSelect={onSelectLang}\r\n    />,\r\n  ];\r\n  let track;\r\n  let i;\r\n  if (tracks && tracks.length) {\r\n    for (i = 0; i < tracks.length; i += 1) {\r\n      track = tracks[i];\r\n      languageOptions.push(\r\n        <MenuItem\r\n          key={`${track.language}-${i}`}\r\n          label={track.label}\r\n          value={track.language}\r\n          selected={selected && track.language === selected}\r\n          onSelect={onSelectLang}\r\n        />,\r\n      );\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Menu\r\n      className={[className || '', 'subtitles-menu'].join(' ')}\r\n      id={id}\r\n      visible={visible}\r\n    >\r\n      {languageOptions}\r\n    </Menu>\r\n  );\r\n};\r\n\r\nexport default SubtitleMenu;\r\n","// @file\r\n// Functional component for a toggle button.\r\n\r\nimport React from 'react';\r\n\r\nimport SrOnly from './SrOnly';\r\nimport CssClasses from './Util/CssClasses';\r\n\r\nimport { IAudioPlayerConfig } from './Types';\r\n\r\ninterface IProps {\r\n  enabled?: boolean;\r\n  hidden?: boolean;\r\n  btnType: string;\r\n  toggleState?: boolean;\r\n  children?: React.ReactNode;\r\n  onClick?: (e: React.MouseEvent) => void;\r\n  className?: string;\r\n  config?: IAudioPlayerConfig;\r\n}\r\n\r\nconst ToggleButton: React.FunctionComponent<IProps> = ({\r\n  enabled = true,\r\n  hidden = false,\r\n  btnType,\r\n  toggleState = false,\r\n  children,\r\n  onClick,\r\n  className,\r\n  config = {},\r\n}: IProps) => {\r\n  const defaultClassName = (config.classNames[btnType] || []).join(' ');\r\n  const iconClassNamesFalse = (config.icons[`${btnType}__false`] || []).join(\r\n    ' ',\r\n  );\r\n  const iconClassNamesTrue = (config.icons[`${btnType}__true`] || []).join(' ');\r\n  const iconElemFalse = config.iconElements[`${btnType}__false`] || null;\r\n  const iconElemTrue = config.iconElements[`${btnType}__true`] || null;\r\n  return (\r\n    <button\r\n      className={CssClasses(defaultClassName, className || '')}\r\n      disabled={!enabled}\r\n      hidden={hidden}\r\n      onClick={onClick}\r\n    >\r\n      <SrOnly config={config}>{children}</SrOnly>\r\n      {!toggleState && !iconElemFalse && (\r\n        <span className={CssClasses(iconClassNamesFalse)} />\r\n      )}\r\n      {!toggleState && iconElemFalse}\r\n      {toggleState && !iconElemTrue && (\r\n        <span className={CssClasses(iconClassNamesTrue)} />\r\n      )}\r\n      {toggleState && iconElemTrue}\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default ToggleButton;\r\n","// @file\r\n// Oral Histories subtitle menu.\r\n\r\nimport React from 'react';\r\n\r\nimport Menu from './Menu';\r\nimport MenuItem from './MenuItem';\r\n\r\ninterface IProps {\r\n  tracklist?: AudioTrack[];\r\n  selected?: number;\r\n  onSelect?: (track: number) => void;\r\n  id?: string;\r\n  visible?: boolean;\r\n  className?: string;\r\n}\r\n\r\nconst TracklistMenu: React.FunctionComponent<IProps> = ({\r\n  tracklist = [],\r\n  selected = 0,\r\n  visible = false,\r\n  onSelect,\r\n  id,\r\n  className,\r\n}: IProps) => {\r\n  const onSelectTrack = (e: React.MouseEvent | React.KeyboardEvent) => {\r\n    const itemElem = e.target as HTMLElement;\r\n    const indexAttr = itemElem.getAttribute('data-value') || null;\r\n    if (indexAttr === null) {\r\n      return;\r\n    }\r\n    const index = parseInt(indexAttr, 10);\r\n    if (typeof onSelect === 'function') {\r\n      onSelect(index);\r\n    }\r\n  };\r\n\r\n  const trackOptions = tracklist.map((track: AudioTrack, index: number) => {\r\n    return (\r\n      <MenuItem\r\n        key={index}\r\n        label={track.label}\r\n        value={index}\r\n        selected={index === selected}\r\n        onSelect={onSelectTrack}\r\n      />\r\n    );\r\n  });\r\n\r\n  return (\r\n    <Menu\r\n      className={[className || '', 'track-menu'].join(' ')}\r\n      id={id}\r\n      visible={visible}\r\n    >\r\n      {trackOptions}\r\n    </Menu>\r\n  );\r\n};\r\n\r\nexport default TracklistMenu;\r\n","// @file\r\n// Time utilities.\r\n\r\nconst strPadLeft = (n: number): string => {\r\n  if (n < 10) {\r\n    return `0${n}`;\r\n  }\r\n  return n.toString();\r\n};\r\n\r\nexport const toHHMMSS = (str: string): string => {\r\n  const secNum = parseInt(str, 10);\r\n  if (isNaN(secNum)) {\r\n    return '';\r\n  }\r\n  const hours = Math.floor(secNum / 3600);\r\n  const minutes = Math.floor((secNum - hours * 3600) / 60);\r\n  const seconds = secNum - hours * 3600 - minutes * 60;\r\n\r\n  return `${strPadLeft(hours)}:${strPadLeft(minutes)}:${strPadLeft(seconds)}`;\r\n};\r\n\r\nexport const toMMSS = (str: string): string => {\r\n  const secNum = parseInt(str, 10);\r\n  if (isNaN(secNum)) {\r\n    return '';\r\n  }\r\n  const minutes = Math.floor(secNum / 60);\r\n  const seconds = secNum - minutes * 60;\r\n\r\n  return `${strPadLeft(minutes)}:${strPadLeft(seconds)}`;\r\n};\r\n","// @file\r\n// Audio player base component.\r\n\r\nimport Emitter from 'eventemitter3';\r\nimport React from 'react';\r\n\r\nimport ActionButton from './ActionButton';\r\nimport ScrubBar from './ScrubBar';\r\nimport SubtitleContainer from './SubtitleContainer';\r\nimport SubtitleMenu from './SubtitleMenu';\r\nimport ToggleButton from './ToggleButton';\r\nimport TracklistMenu from './TracklistMenu';\r\n\r\nimport FontAwesome5 from './Configs/FontAwesome5';\r\nimport CssClasses from './Util/CssClasses';\r\nimport { toHHMMSS, toMMSS } from './TimeUtils';\r\nimport { IAudioPlayerConfig } from './Types';\r\n\r\ninterface IPlaylistItem {\r\n  index: number;\r\n  label: string;\r\n  audioUrl: string;\r\n  transcriptUrl: string | null;\r\n}\r\n\r\ninterface IPlaybackEvent {\r\n  fileData?: any[];\r\n  selectedFile?: number;\r\n  currentTime?: number;\r\n  duration?: number;\r\n}\r\n\r\ninterface IProps {\r\n  playlist: IPlaylistItem[];\r\n  id?: string;\r\n  className?: string;\r\n  eventRouter?: Emitter;\r\n  crossOrigin?: 'anonymous' | 'use-credentials';\r\n  onEndNextFile?: boolean;\r\n  config?: IAudioPlayerConfig;\r\n  singleTrack?: boolean;\r\n  useRangeOnScrubBar?: boolean;\r\n  useProgressOnScrubBar?: boolean;\r\n  onLoad?: (e?: IPlaybackEvent) => void;\r\n  onPlay?: (e?: IPlaybackEvent) => void;\r\n  onPause?: (e?: IPlaybackEvent) => void;\r\n  onEnd?: (e?: IPlaybackEvent) => void;\r\n  onTimeUpdate?: (e?: IPlaybackEvent) => void;\r\n}\r\n\r\nconst AudioPlayer: React.FunctionComponent<IProps> = ({\r\n  playlist = [],\r\n  id = 'audio-player',\r\n  className,\r\n  eventRouter,\r\n  crossOrigin,\r\n  onEndNextFile = false,\r\n  config = {},\r\n  singleTrack = false,\r\n  useRangeOnScrubBar = false,\r\n  useProgressOnScrubBar = false,\r\n  onLoad,\r\n  onPlay,\r\n  onPause,\r\n  onEnd,\r\n  onTimeUpdate,\r\n}: IProps) => {\r\n  const audioElem = React.useRef(null);\r\n  const timeElapsedElem = React.useRef(null);\r\n  const durationElem = React.useRef(null);\r\n\r\n  const [duration, setDuration] = React.useState(0);\r\n  const [timestamp, setTimestamp] = React.useState(0);\r\n  const [fileData, setFileData] = React.useState([]);\r\n  const [selectedFile, setSelectedFile] = React.useState(0);\r\n  const [progress, setProgress] = React.useState(0);\r\n  const [playing, setPlaying] = React.useState(false);\r\n  const [ended, setEnded] = React.useState(false);\r\n  const [muted, setMuted] = React.useState(false);\r\n  const [selectedLanguage, setSelectedLanguage] = React.useState(null);\r\n  const [showTrackListMenu, setShowTrackListMenu] = React.useState(false);\r\n  const [showSubtitleMenu, setShowSubtitleMenu] = React.useState(false);\r\n  const [videoMetadataLoaded, setVideoMetadataLoaded] = React.useState(false);\r\n\r\n  const captionsContainerId = `${id}__captions`;\r\n  const timeIndicatorId = `${id}__time-indicator`;\r\n  const durationIndicatorId = `${id}__duration-indicator`;\r\n  const tracklistId = `${id}__track-list`;\r\n  const subtitleMenuId = `${id}__subtitle-menu`;\r\n\r\n  const getTimestampString = (\r\n    seconds: number = 0,\r\n    isDuration: boolean = false,\r\n  ): string => {\r\n    if (typeof seconds !== 'number') {\r\n      return '';\r\n    }\r\n    if (\r\n      config.useHoursInTimestamps &&\r\n      ((isDuration && seconds >= 3600) || duration >= 3600)\r\n    ) {\r\n      return toHHMMSS(seconds.toString());\r\n    }\r\n    return toMMSS(seconds.toString());\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    audioElem.current.setAttribute('playsinline', 'playsinline');\r\n  }, []);\r\n\r\n  React.useEffect(() => {\r\n    setFileData(playlist);\r\n    setSelectedFile(0);\r\n  }, [playlist]);\r\n\r\n  const canPlayPrev = selectedFile > 0;\r\n  const canPlayNext = selectedFile < fileData.length - 1;\r\n\r\n  React.useEffect(() => {\r\n    audioElem.current.load();\r\n    audioElem.current.currentTime = 0;\r\n    setProgress(0);\r\n  }, [selectedFile]);\r\n\r\n  const selectTrack = (trackNumber: number) => {\r\n    setPlaying(false);\r\n    setEnded(false);\r\n    setVideoMetadataLoaded(false);\r\n    setSelectedFile(trackNumber);\r\n    if (typeof onLoad === 'function') {\r\n      onLoad({ fileData, selectedFile: trackNumber, duration });\r\n    }\r\n  };\r\n\r\n  const hasVtt = (file: IPlaylistItem) => {\r\n    return file.transcriptUrl && file.transcriptUrl.length > 0;\r\n  };\r\n\r\n  const subtitleTracks = () => {\r\n    if (!videoMetadataLoaded) {\r\n      return [];\r\n    }\r\n    return audioElem.current.textTracks;\r\n  };\r\n\r\n  const playable = fileData && fileData.length && videoMetadataLoaded;\r\n\r\n  const selectSubtitleLanguage = (lang?: string) => {\r\n    setShowSubtitleMenu(false);\r\n    setSelectedLanguage(lang && lang.length ? lang : null);\r\n  };\r\n\r\n  const onLoadedMetadata = () => {\r\n    setVideoMetadataLoaded(true);\r\n    selectSubtitleLanguage(selectedLanguage);\r\n    setDuration(audioElem.current.duration);\r\n\r\n    // this.highlighter.selectedFile = this.state.selectedFile;\r\n    // this.highlighter.updateVideoElement(this.videoElement);\r\n    // this.highlighter.onVideoElementLoad();\r\n  };\r\n\r\n  const internalOnTimeUpdate = () => {\r\n    const currentTime = audioElem.current.currentTime;\r\n    if (duration > 0) {\r\n      const value = (100 / duration) * currentTime;\r\n      setProgress(value);\r\n      setTimestamp(currentTime);\r\n    }\r\n    if (typeof onTimeUpdate === 'function') {\r\n      onTimeUpdate({ fileData, selectedFile, currentTime, duration });\r\n    }\r\n  };\r\n\r\n  const playPauseAction = () => {\r\n    if (!playable) {\r\n      return;\r\n    }\r\n    let newPlaying = false;\r\n    if (audioElem.current.paused) {\r\n      audioElem.current.play();\r\n      newPlaying = true;\r\n    } else {\r\n      audioElem.current.pause();\r\n    }\r\n    const currentTime = audioElem.current.currentTime;\r\n    setPlaying(newPlaying);\r\n    setTimestamp(currentTime);\r\n    if (eventRouter) {\r\n      eventRouter.emit('state.playing', newPlaying);\r\n    }\r\n    if (newPlaying) {\r\n      if (typeof onPlay === 'function') {\r\n        onPlay({ fileData, selectedFile, currentTime, duration });\r\n      }\r\n    } else {\r\n      if (typeof onPause === 'function') {\r\n        onPause({ fileData, selectedFile, currentTime, duration });\r\n      }\r\n    }\r\n  };\r\n\r\n  const nextTrackAction = () => {\r\n    if (canPlayNext) {\r\n      selectTrack(selectedFile + 1);\r\n    }\r\n  };\r\n\r\n  const nextTrackAndPlayAction = () => {\r\n    if (canPlayNext) {\r\n      nextTrackAction();\r\n      setTimeout(() => playPauseAction(), 500);\r\n    }\r\n  };\r\n\r\n  const onEnded = () => {\r\n    if (onEndNextFile) {\r\n      nextTrackAndPlayAction();\r\n      return;\r\n    }\r\n    setEnded(true);\r\n    const currentTime = audioElem.current.currentTime;\r\n    setTimestamp(currentTime);\r\n    if (eventRouter) {\r\n      eventRouter.emit('state.playing', false);\r\n      eventRouter.emit('state.ended', true);\r\n    }\r\n    if (typeof onEnd === 'function') {\r\n      onEnd({ fileData, selectedFile, currentTime, duration });\r\n    }\r\n  };\r\n\r\n  const moveBackwardAction = () => {\r\n    if (!playable) {\r\n      return;\r\n    }\r\n    audioElem.current.currentTime -= config.rewindTime || 5;\r\n  };\r\n\r\n  const moveForwardAction = () => {\r\n    if (!playable) {\r\n      return;\r\n    }\r\n    audioElem.current.currentTime += config.fastForwardTime || 5;\r\n  };\r\n\r\n  const rewindAction = () => {\r\n    audioElem.current.currentTime = 0;\r\n    setEnded(false);\r\n    setTimestamp(audioElem.current.currentTime);\r\n    setProgress(0);\r\n    if (eventRouter) {\r\n      eventRouter.emit('state.ended', false);\r\n    }\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    let i;\r\n    for (i = 0; i < audioElem.current.textTracks.length; i += 1) {\r\n      audioElem.current.textTracks[i].mode =\r\n        audioElem.current.textTracks[i].language === selectedLanguage\r\n          ? 'showing'\r\n          : 'hidden';\r\n    }\r\n  }, [selectedLanguage]);\r\n\r\n  const toggleMuteAction = () => {\r\n    const newMute = !audioElem.current.muted;\r\n    audioElem.current.muted = newMute;\r\n    setMuted(newMute);\r\n  };\r\n\r\n  const handleRemoteAction = (action: string) => {\r\n    if (action === 'backward') {\r\n      moveBackwardAction();\r\n    } else if (action === 'play_pause') {\r\n      playPauseAction();\r\n    } else if (action === 'reset') {\r\n      rewindAction();\r\n    } else if (action === 'forward') {\r\n      moveForwardAction();\r\n    }\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    if (eventRouter) {\r\n      eventRouter.on('remote.action', handleRemoteAction);\r\n    }\r\n    return () => {\r\n      if (eventRouter) {\r\n        eventRouter.off('remote.action', handleRemoteAction);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  const currentFile = fileData[selectedFile] || null;\r\n\r\n  return (\r\n    <div className={CssClasses('video-wrapper', className)}>\r\n      <audio\r\n        className={CssClasses('video-element', className)}\r\n        data-oh-audio-player=\"1\"\r\n        crossOrigin={crossOrigin}\r\n        preload=\"metadata\"\r\n        ref={audioElem}\r\n        onLoadedMetadata={onLoadedMetadata}\r\n        onEnded={onEnded}\r\n        onTimeUpdate={internalOnTimeUpdate}\r\n        aria-describedby={captionsContainerId}\r\n      >\r\n        {currentFile && <source src={currentFile.audioUrl} type=\"audio/mpeg\" />}\r\n        {currentFile && hasVtt(currentFile) && (\r\n          <track\r\n            src={currentFile.transcriptUrl}\r\n            kind=\"captions\"\r\n            label=\"English\"\r\n            srcLang=\"en\"\r\n          />\r\n        )}\r\n      </audio>\r\n\r\n      <div className={CssClasses('video-controls', className)}>\r\n        <ScrubBar\r\n          defaultValue={progress}\r\n          className={CssClasses('video-controls', className, 'progress-bar')}\r\n          onClick={(pos: number) => {\r\n            audioElem.current.currentTime = pos * duration;\r\n            setTimestamp(pos * duration);\r\n          }}\r\n          useTooltip={config.useTooltip || false}\r\n          useRange={useRangeOnScrubBar}\r\n          useProgress={useProgressOnScrubBar}\r\n          valueToTooltipString={(pos) =>\r\n            getTimestampString(\r\n              audioElem.current ? pos * audioElem.current.duration : 0,\r\n            )\r\n          }\r\n        />\r\n\r\n        <label className=\"sr-only\" htmlFor={timeIndicatorId}>\r\n          Time elapsed\r\n        </label>\r\n\r\n        <input\r\n          className={CssClasses('video-controls', className, 'time-elapsed')}\r\n          id={timeIndicatorId}\r\n          readOnly\r\n          ref={timeElapsedElem}\r\n          value={getTimestampString(timestamp)}\r\n        />\r\n\r\n        {config.showDuration && (\r\n          <>\r\n            <label className=\"sr-only\" htmlFor={durationIndicatorId}>\r\n              Duration\r\n            </label>\r\n\r\n            <input\r\n              className={CssClasses('video-controls', className, 'duration')}\r\n              id={durationIndicatorId}\r\n              readOnly\r\n              ref={durationElem}\r\n              value={getTimestampString(duration, true)}\r\n            />\r\n          </>\r\n        )}\r\n\r\n        <div className=\"w-100\" />\r\n\r\n        <div\r\n          className={CssClasses('video-controls', className, 'button-wrapper')}\r\n        >\r\n          <ToggleButton\r\n            btnType=\"tracklist\"\r\n            aria-controls={tracklistId}\r\n            enabled={fileData.length > 0 && !singleTrack}\r\n            onClick={() => {\r\n              setShowSubtitleMenu(false);\r\n              setShowTrackListMenu(!showTrackListMenu);\r\n            }}\r\n            toggleState={showTrackListMenu}\r\n            config={config}\r\n          >\r\n            Tracklist\r\n          </ToggleButton>\r\n\r\n          <div\r\n            className={CssClasses(\r\n              'video-controls',\r\n              className,\r\n              'button-wrapper__space',\r\n            )}\r\n          />\r\n\r\n          <ActionButton\r\n            btnType=\"previous-audio\"\r\n            enabled={fileData.length > 1 && canPlayPrev}\r\n            onClick={() => {\r\n              if (canPlayPrev) {\r\n                selectTrack(selectedFile - 1);\r\n              }\r\n            }}\r\n            config={config}\r\n          >\r\n            Previous track\r\n          </ActionButton>\r\n\r\n          <ActionButton\r\n            btnType=\"backward\"\r\n            onClick={moveBackwardAction}\r\n            config={config}\r\n          >\r\n            Rewind\r\n          </ActionButton>\r\n\r\n          <ToggleButton\r\n            btnType=\"play\"\r\n            hidden={ended}\r\n            onClick={playPauseAction}\r\n            toggleState={playing}\r\n            config={config}\r\n          >\r\n            {playing ? 'Pause' : 'Play'}\r\n          </ToggleButton>\r\n\r\n          <ActionButton\r\n            btnType=\"reset\"\r\n            enabled={ended}\r\n            hidden={!ended}\r\n            onClick={rewindAction}\r\n            config={config}\r\n          >\r\n            Restart\r\n          </ActionButton>\r\n\r\n          <ActionButton\r\n            btnType=\"forward\"\r\n            onClick={moveForwardAction}\r\n            config={config}\r\n          >\r\n            Fast forward\r\n          </ActionButton>\r\n\r\n          <ActionButton\r\n            btnType=\"next-audio\"\r\n            enabled={fileData.length > 1 && canPlayNext}\r\n            onClick={nextTrackAction}\r\n            config={config}\r\n          >\r\n            Next track\r\n          </ActionButton>\r\n\r\n          <ToggleButton\r\n            btnType=\"closed-captioning\"\r\n            aria-controls={subtitleMenuId}\r\n            enabled={videoMetadataLoaded && hasVtt(currentFile)}\r\n            onClick={() => {\r\n              setShowTrackListMenu(false);\r\n              setShowSubtitleMenu(!showSubtitleMenu);\r\n            }}\r\n            toggleState={showSubtitleMenu}\r\n            config={config}\r\n          >\r\n            Closed captioning\r\n          </ToggleButton>\r\n\r\n          <div\r\n            className={CssClasses(\r\n              'video-controls',\r\n              className,\r\n              'button-wrapper__space',\r\n            )}\r\n          />\r\n\r\n          <ToggleButton\r\n            btnType=\"mute\"\r\n            onClick={toggleMuteAction}\r\n            toggleState={muted}\r\n            config={config}\r\n          >\r\n            Mute\r\n          </ToggleButton>\r\n        </div>\r\n      </div>\r\n\r\n      <SubtitleMenu\r\n        visible={showSubtitleMenu}\r\n        id={subtitleMenuId}\r\n        tracks={subtitleTracks()}\r\n        selected={selectedLanguage}\r\n        onSelect={selectSubtitleLanguage}\r\n      />\r\n\r\n      <TracklistMenu\r\n        visible={!singleTrack && showTrackListMenu}\r\n        id={tracklistId}\r\n        tracklist={fileData}\r\n        selected={selectedFile}\r\n        onSelect={(trackNumber) => {\r\n          setShowTrackListMenu(false);\r\n          selectTrack(trackNumber);\r\n        }}\r\n      />\r\n\r\n      <SubtitleContainer\r\n        visible={selectedLanguage !== null}\r\n        lang={selectedLanguage}\r\n        tracks={subtitleTracks()}\r\n        id={captionsContainerId}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AudioPlayer;\r\n\r\nexport const defaultConfigs = {\r\n  FontAwesome5,\r\n};\r\n"],"names":["SrOnly","config","children","classNames","concat","React","className","join","CssClasses","defaultClassName","optionalClassName","suffix","states","classes","split","filter","c","length","map","reduce","agg","s","state","ActionButton","enabled","hidden","btnType","onClick","iconClassNames","icons","iconElem","iconElements","disabled","clampNumber","num","min","max","Math","getOffsetXNative","e","container","offsetX","rect","getBoundingClientRect","type","pageX","left","targetTouches","getOffsetX","nativeEvent","touchE","target","ON_CLICK_DEBOUNCE","ScrubBarTooltip","title","style","ScrubBarTooltipOuter","wrapperClassName","tooltipClassName","valueToTooltipString","defaultValue","show","outer","useRef","useState","value","setValue","outerWidth","current","clientWidth","content","ref","onMouseMove","ScrubBar","useTooltip","useRange","useProgress","id","label","scrubbing","hover","setHover","setOffsetX","lastUpdate","setLastUpdate","derivedId","debouncedOnClick","debounce","onDown","onUp","Date","getTime","onTouchMove","useEffect","document","addEventListener","removeEventListener","pos","onMouseOver","onMouseLeave","onMouseDown","onTouchStart","htmlFor","onChange","parseFloat","currentTarget","width","memoiseTrack","track","kind","mode","language","cues","SubtitleContainer","visible","lang","tracks","text","setText","currentTrack","setCurrentTrack","cueChange","activeCues","newText","cue","i","Menu","MenuItem","selected","onSelect","onKeyUp","key","SubtitleMenu","onSelectLang","itemElem","selectedLang","getAttribute","languageOptions","push","ToggleButton","toggleState","iconClassNamesFalse","iconClassNamesTrue","iconElemFalse","iconElemTrue","TracklistMenu","tracklist","onSelectTrack","indexAttr","index","parseInt","trackOptions","strPadLeft","n","toString","toHHMMSS","str","secNum","isNaN","hours","floor","minutes","seconds","toMMSS","AudioPlayer","playlist","eventRouter","crossOrigin","onEndNextFile","singleTrack","useRangeOnScrubBar","useProgressOnScrubBar","onLoad","onPlay","onPause","onEnd","onTimeUpdate","audioElem","timeElapsedElem","durationElem","duration","setDuration","timestamp","setTimestamp","fileData","setFileData","selectedFile","setSelectedFile","progress","setProgress","playing","setPlaying","ended","setEnded","muted","setMuted","selectedLanguage","setSelectedLanguage","showTrackListMenu","setShowTrackListMenu","showSubtitleMenu","setShowSubtitleMenu","videoMetadataLoaded","setVideoMetadataLoaded","captionsContainerId","timeIndicatorId","durationIndicatorId","tracklistId","subtitleMenuId","getTimestampString","isDuration","useHoursInTimestamps","setAttribute","canPlayPrev","canPlayNext","load","currentTime","selectTrack","trackNumber","hasVtt","file","transcriptUrl","subtitleTracks","textTracks","playable","selectSubtitleLanguage","onLoadedMetadata","internalOnTimeUpdate","playPauseAction","newPlaying","paused","play","pause","emit","nextTrackAction","nextTrackAndPlayAction","setTimeout","onEnded","moveBackwardAction","rewindTime","moveForwardAction","fastForwardTime","rewindAction","toggleMuteAction","newMute","handleRemoteAction","action","on","off","currentFile","preload","src","audioUrl","srcLang","readOnly","showDuration"],"mappings":"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"}