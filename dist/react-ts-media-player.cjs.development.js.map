{"version":3,"file":"react-ts-media-player.cjs.development.js","sources":["../src/SrOnly.tsx","../src/Util/CssClasses.ts","../src/ActionButton.tsx","../src/Util/Numbers.ts","../src/ScrubBar.tsx","../src/SubtitleContainer.tsx","../src/Menu.tsx","../src/MenuItem.tsx","../src/SubtitleMenu.tsx","../src/ToggleButton.tsx","../src/TracklistMenu.tsx","../src/TimeUtils.ts","../src/AudioPlayer.tsx"],"sourcesContent":["// @file\n// Screenreader only wrapper.\n\nimport React from 'react';\n\nimport { IAudioPlayerConfig } from './Types';\n\ninterface IProps {\n  children?: React.ReactNode;\n  config?: IAudioPlayerConfig;\n}\n\nconst SrOnly: React.FunctionComponent<IProps> = ({ config = {}, children }) => {\n  const classNames = [].concat(config.classNames['sr-only'] || []);\n  return <span className={classNames.join(' ')}>{children}</span>;\n};\n\nexport default SrOnly;\n","// @file\n// Generate BEM-scoped CSS classes.\n\nconst CssClasses = (defaultClassName: string, optionalClassName: string = '', suffix: string = '', states: any[] = []): string => {\n  const classes = [].concat(defaultClassName.split(/\\s+/))\n    .concat(optionalClassName.split(/\\s+/))\n    .filter(c => c && c.length)\n    .map(c => suffix.length ? `${c}__${suffix}` : c);\n\n  return classes.reduce((agg, className) => agg\n    .concat([''].concat(states.filter(s => s && s.length))\n    .map(state => `${className}${state.length ? `--${state}` : ''}`)\n  ), []).join(' ');\n};\n\nexport default CssClasses;\n","// @file\n// Functional component for an action button.\n\nimport React from 'react';\n\nimport SrOnly from './SrOnly';\nimport CssClasses from './Util/CssClasses';\n\nimport { IAudioPlayerConfig } from './Types';\n\ninterface IProps {\n  btnType: string;\n  enabled?: boolean;\n  hidden?: boolean;\n  onClick?: (e: React.MouseEvent) => void;\n  children?: React.ReactNode;\n  className?: string;\n  config?: IAudioPlayerConfig;\n}\n\nconst ActionButton: React.FunctionComponent<IProps> = ({\n  enabled = true,\n  hidden = false,\n  btnType,\n  onClick,\n  children,\n  className,\n  config = {},\n}) => {\n  const defaultClassName = (config.classNames[btnType] || []).join(' ');\n  const iconClassNames = (config.icons[btnType] || []).join(' ');\n  const iconElem = config.iconElements[btnType] || null;\n  return (\n    <button\n      className={CssClasses(defaultClassName, className || '')}\n      disabled={!enabled}\n      hidden={hidden}\n      onClick={onClick}\n    >\n      <SrOnly config={config}>{children}</SrOnly>\n      {!iconElem && <span className={CssClasses(iconClassNames, '')}></span>}\n      {iconElem}\n    </button>\n  );\n};\n\nexport default ActionButton;\n","export const clampNumber = (\n  num: number,\n  min: number,\n  max: number,\n): number => Math.max(min, Math.min(max, num));\n","// @file\n// Functional component for an action button.\n\nimport React from 'react';\nimport debounce from 'debounce';\n\nimport { clampNumber } from './Util/Numbers';\n\ninterface IProps {\n  defaultValue: number;\n  className?: string;\n  onClick?: (pos: number) => void;\n}\n\nconst getOffsetXNative = (e: MouseEvent | TouchEvent, container: HTMLDivElement) => {\n  let offsetX = 0;\n  const rect = container.getBoundingClientRect();\n  if (e.type === 'mousemove') {\n    offsetX = (e as MouseEvent).pageX - rect.left;\n  }\n  if (e.type === 'touchmove') {\n    offsetX = (e as TouchEvent).targetTouches[0].pageX - rect.left;\n  }\n  return offsetX;\n};\n\nconst getOffsetX = (e: React.TouchEvent | React.MouseEvent) => {\n  if (typeof (e as React.MouseEvent).nativeEvent.offsetX === 'number') {\n    return (e as React.MouseEvent).nativeEvent.offsetX;\n  }\n  if (typeof (e as React.TouchEvent).targetTouches === 'object') {\n    const touchE = e as React.TouchEvent;\n    const rect = (touchE.target as HTMLDivElement).getBoundingClientRect();\n    return touchE.targetTouches[0].pageX - rect.left;\n  }\n  return 0;\n};\n\nconst ON_CLICK_DEBOUNCE = 250;\n\nconst ScrubBar: React.FunctionComponent<IProps> = ({\n  defaultValue = 0,\n  className,\n  onClick,\n}: IProps) => {\n  const outer = React.useRef(null);\n  const scrubbing = React.useRef(false);\n\n  const [value, setValue] = React.useState(clampNumber(defaultValue, 0, 1));\n  const [offsetX, setOffsetX] = React.useState(0);\n  const [lastUpdate, setLastUpdate] = React.useState(0);\n\n  const debouncedOnClick = typeof onClick === 'function'\n    ? debounce(onClick, ON_CLICK_DEBOUNCE)\n    : () => {};\n\n  const onDown = (e: React.TouchEvent | React.MouseEvent) => {\n    scrubbing.current = true;\n    setOffsetX(getOffsetX(e));\n  };\n\n  const onUp = () => {\n    if (scrubbing.current) {\n      scrubbing.current = false;\n      setLastUpdate((new Date()).getTime());\n    }\n  };\n\n  const onMouseMove = (e: MouseEvent) => {\n    if (scrubbing.current) {\n      setOffsetX(getOffsetXNative(e, outer.current));\n    }\n  };\n\n  const onTouchMove = (e: TouchEvent) => {\n    if (scrubbing.current) {\n      setOffsetX(getOffsetXNative(e, outer.current));\n    }\n  };\n\n  // Set up cursor move and cursor up events on the entire document\n  // so that the scrub can persist even when the user drags outside\n  // the scrub bar. \n  React.useEffect(() => {\n    document.addEventListener('mousemove', onMouseMove, false);\n    document.addEventListener('touchmove', onTouchMove, false);\n    document.addEventListener('mouseup', onUp, false);\n    document.addEventListener('touchend', onUp, false);\n    return () => {\n      document.removeEventListener('mousemove', onMouseMove, false);\n      document.removeEventListener('touchmove', onTouchMove, false);\n      document.removeEventListener('mouseup', onUp, false);\n      document.removeEventListener('touchend', onUp, false);\n    };\n  }, []);\n\n  // Prop update -- set value, don't propagate.\n  React.useEffect(() => {\n    setValue(clampNumber(defaultValue, 0, 1));\n  }, [defaultValue]);\n\n  // State update -- set value, propagate back to parent.\n  React.useEffect(() => {\n    if (scrubbing.current) {\n      const pos = clampNumber(offsetX / outer.current.clientWidth, 0, 1);\n      setValue(pos * 100);\n      debouncedOnClick(pos);\n    }\n  }, [lastUpdate, offsetX]);\n\n  return (\n    <div\n      className={[className || ''].join(' ')}\n      onMouseDown={onDown}\n      onTouchStart={onDown}\n      ref={outer}\n    >\n      <div\n        className={[`${className}__fill`].join(' ')}\n        style={{ width: `${value}%` }}\n      >\n        <span className=\"sr-only\">{`${value} percent`}</span>\n      </div>\n    </div>\n  );\n};\n\nexport default ScrubBar;\n","// @file\n// Oral Histories subtitle menu.\n\nimport React from 'react';\n\nconst memoiseTrack = (track: TextTrack): string => {\n  if (!track) {\n    return '';\n  }\n  const { kind, mode, language, cues } = track;\n  return [kind, mode, language, cues.length].join(',');\n};\n\ninterface IProps {\n  visible?: boolean;\n  lang?: string;\n  tracks: TextTrack[];\n  id: string;\n  className?: string;\n}\n\nconst SubtitleContainer: React.FunctionComponent<IProps> = ({\n  visible = true,\n  lang,\n  tracks = [],\n  id,\n  className,\n}: IProps) => {\n  const [text, setText] = React.useState('');\n  const [currentTrack, setCurrentTrack] = React.useState(null);\n\n  const cueChange = (e: Event) => {\n    const { activeCues } = e.target as TextTrack;\n\n    let newText = '';\n    let cue;\n\n    let i;\n    for (i = 0; i < activeCues.length; i += 1) {\n      cue = activeCues[i];\n      if (typeof cue.text !== 'undefined') {\n        newText += cue.text;\n      }\n    }\n    setText(newText);\n  };\n\n  React.useEffect(() => {\n    if (currentTrack) {\n      currentTrack.addEventListener('cuechange', cueChange, false);\n    }\n    return () => {\n      if (currentTrack) {\n        currentTrack.removeEventListener('cuechange', cueChange, false);\n      }\n    };\n  }, [memoiseTrack(currentTrack)]);\n\n  React.useEffect(() => {\n    if (lang && lang.length && tracks && tracks.length) {\n      let track = null;\n      let i;\n      for (i = 0; i < tracks.length; i += 1) {\n        if (tracks[i].language === lang) {\n          track = tracks[i];\n          break;\n        }\n      }\n      setCurrentTrack(track);\n    }\n  }, [lang, tracks]);\n\n  return (\n    <div\n      className={[className || '', 'video-wrapper__subtitle-container'].join(\n        ' ',\n      )}\n      hidden={!visible}\n      aria-hidden={!visible}\n      lang={lang}\n      id={id}\n      aria-atomic=\"true\"\n      aria-live=\"polite\"\n      aria-relevant=\"additions text\"\n    >\n      {visible ? text : ' '}\n    </div>\n  );\n};\n\nexport default SubtitleContainer;\n","// @file\r\n// Menu container.\r\n\r\nimport React from 'react';\r\n\r\ninterface IProps {\r\n  id?: string;\r\n  visible?: boolean;\r\n  className?: string;\r\n  children?: React.ReactNode;\r\n}\r\n\r\nconst Menu: React.FunctionComponent<IProps> = ({\r\n  id,\r\n  visible = false,\r\n  className,\r\n  children,\r\n}: IProps) => {\r\n  return (\r\n    <ol\r\n      className={['video-wrapper__popup-menu', className || ''].join(' ')}\r\n      id={id}\r\n      hidden={!visible}\r\n      aria-expanded={visible}\r\n    >\r\n      {children}\r\n    </ol>\r\n  );\r\n};\r\n\r\nexport default Menu;\r\n","import React from 'react';\n\ninterface IProps {\n  label: string;\n  value: string | number | null;\n  selected: boolean;\n  onSelect: (e: React.KeyboardEvent | React.MouseEvent) => void;\n}\n\nconst MenuItem: React.FunctionComponent<IProps> = ({\n  label,\n  value,\n  selected = false,\n  onSelect,\n}: IProps) => {\n  return (\n    <li>\n      <button\n        data-value={value}\n        data-state={selected ? 'active' : 'inactive'}\n        onClick={onSelect}\n        onKeyUp={(e) => {\n          if (e.key === 'Enter') {\n            onSelect(e);\n          }\n        }}\n      >\n        {label}\n      </button>\n    </li>\n  );\n};\n\nexport default MenuItem;\n","// @file\n// Oral Histories subtitle menu.\n\nimport React from 'react';\n\nimport Menu from './Menu';\nimport MenuItem from './MenuItem';\n\ninterface IProps {\n  visible: boolean;\n  id: string;\n  tracks: TextTrackList;\n  selected?: string;\n  onSelect: (selectedLang: string) => void;\n  className?: string;\n}\n\nconst SubtitleMenu: React.FunctionComponent<IProps> = ({\n  visible = false,\n  id,\n  tracks,\n  selected,\n  onSelect,\n  className,\n}: IProps) => {\n  const onSelectLang = (e: React.MouseEvent | React.KeyboardEvent) => {\n    const itemElem = e.target as HTMLElement;\n    const selectedLang = itemElem.getAttribute('data-value') || null;\n    if (typeof onSelect === 'function') {\n      onSelect(selectedLang);\n    }\n  };\n\n  const languageOptions = [\n    <MenuItem\n      key={'_none_'}\n      label={'Off'}\n      value={null}\n      selected={!selected}\n      onSelect={onSelectLang}\n    />,\n  ];\n  let track;\n  let i;\n  if (tracks && tracks.length) {\n    for (i = 0; i < tracks.length; i += 1) {\n      track = tracks[i];\n      languageOptions.push(\n        <MenuItem\n          key={`${track.language}-${i}`}\n          label={track.label}\n          value={track.language}\n          selected={selected && track.language === selected}\n          onSelect={onSelectLang}\n        />,\n      );\n    }\n  }\n\n  return (\n    <Menu\n      className={[className || '', 'subtitles-menu'].join(' ')}\n      id={id}\n      visible={visible}\n    >\n      {languageOptions}\n    </Menu>\n  );\n};\n\nexport default SubtitleMenu;\n","// @file\n// Functional component for a toggle button.\n\nimport React from 'react';\n\nimport SrOnly from './SrOnly';\nimport CssClasses from './Util/CssClasses';\n\nimport { IAudioPlayerConfig } from './Types';\n\ninterface IProps {\n  enabled?: boolean;\n  hidden?: boolean;\n  btnType: string;\n  toggleState?: boolean;\n  children?: React.ReactNode;\n  onClick?: (e: React.MouseEvent) => void;\n  className?: string;\n  config?: IAudioPlayerConfig;\n}\n\nconst ToggleButton: React.FunctionComponent<IProps> = ({\n  enabled = true,\n  hidden = false,\n  btnType,\n  toggleState = false,\n  children,\n  onClick,\n  className,\n  config = {},\n}: IProps) => {\n  const defaultClassName = (config.classNames[btnType] || []).join(' ');\n  const iconClassNamesFalse = (config.icons[`${btnType}__false`] || []).join(' ');\n  const iconClassNamesTrue = (config.icons[`${btnType}__true`] || []).join(' ');\n  const iconElemFalse = config.iconElements[`${btnType}__false`] || null;\n  const iconElemTrue = config.iconElements[`${btnType}__true`] || null;\n  return (\n    <button\n      className={CssClasses(defaultClassName, className || '')}\n      disabled={!enabled}\n      hidden={hidden}\n      onClick={onClick}\n    >\n      <SrOnly config={config}>{children}</SrOnly>\n      {!toggleState && !iconElemFalse && (<span\n        className={CssClasses(iconClassNamesFalse)}\n      />)}\n      {!toggleState && iconElemFalse}\n      {toggleState && !iconElemTrue && (<span\n        className={CssClasses(iconClassNamesTrue)}\n      />)}\n      {toggleState && iconElemTrue}\n    </button>\n  );\n};\n\nexport default ToggleButton;\n","// @file\r\n// Oral Histories subtitle menu.\r\n\r\nimport React from 'react';\r\n\r\nimport Menu from './Menu';\r\nimport MenuItem from './MenuItem';\r\n\r\ninterface IProps {\r\n  tracklist?: AudioTrack[];\r\n  selected?: number;\r\n  onSelect?: (track: number) => void;\r\n  id?: string;\r\n  visible?: boolean;\r\n  className?: string;\r\n}\r\n\r\nconst TracklistMenu: React.FunctionComponent<IProps> = ({\r\n  tracklist = [],\r\n  selected = 0,\r\n  visible = false,\r\n  onSelect,\r\n  id,\r\n  className,\r\n}: IProps) => {\r\n  const onSelectTrack = (e: React.MouseEvent | React.KeyboardEvent) => {\r\n    const itemElem = e.target as HTMLElement;\r\n    const indexAttr = itemElem.getAttribute('data-value') || null;\r\n    if (indexAttr === null) {\r\n      return;\r\n    }\r\n    const index = parseInt(indexAttr, 10);\r\n    if (typeof onSelect === 'function') {\r\n      onSelect(index);\r\n    }\r\n  };\r\n\r\n  const trackOptions = tracklist.map((track: AudioTrack, index: number) => {\r\n    return (\r\n      <MenuItem\r\n        key={index}\r\n        label={track.label}\r\n        value={index}\r\n        selected={index === selected}\r\n        onSelect={onSelectTrack}\r\n      />\r\n    );\r\n  });\r\n\r\n  return (\r\n    <Menu\r\n      className={[className || '', 'track-menu'].join(' ')}\r\n      id={id}\r\n      visible={visible}\r\n    >\r\n      {trackOptions}\r\n    </Menu>\r\n  );\r\n};\r\n\r\nexport default TracklistMenu;\r\n","// @file\n// Time utilities.\n\nconst strPadLeft = (n: number): string => {\n  if (n < 10) {\n    return `0${n}`;\n  }\n  return n.toString();\n};\n\nexport const toHHMMSS = (str: string): string => {\n  const secNum = parseInt(str, 10);\n  const hours = Math.floor(secNum / 3600);\n  const minutes = Math.floor((secNum - hours * 3600) / 60);\n  const seconds = secNum - hours * 3600 - minutes * 60;\n\n  return `${strPadLeft(hours)}:${strPadLeft(minutes)}:${strPadLeft(seconds)}`;\n};\n\nexport const toMMSS = (str: string): string => {\n  const secNum = parseInt(str, 10);\n  const minutes = Math.floor(secNum / 60);\n  const seconds = secNum - minutes * 60;\n\n  return `${strPadLeft(minutes)}:${strPadLeft(seconds)}`;\n};\n","// @file\n// Audio player base component.\n\nimport Emitter from 'eventemitter3';\nimport React from 'react';\n\nimport ActionButton from './ActionButton';\nimport ScrubBar from './ScrubBar';\nimport SubtitleContainer from './SubtitleContainer';\nimport SubtitleMenu from './SubtitleMenu';\nimport ToggleButton from './ToggleButton';\nimport TracklistMenu from './TracklistMenu';\n\nimport FontAwesome5 from './Configs/FontAwesome5';\nimport CssClasses from './Util/CssClasses';\nimport { toHHMMSS, toMMSS } from './TimeUtils';\nimport { IAudioPlayerConfig } from './Types';\n\ninterface IPlaylistItem {\n  index: number;\n  label: string;\n  audioUrl: string;\n  transcriptUrl: string | null;\n}\n\ninterface IProps {\n  playlist: IPlaylistItem[];\n  id?: string;\n  className?: string;\n  eventRouter?: Emitter;\n  crossOrigin?: 'anonymous' | 'use-credentials';\n  onEndNextFile?: boolean;\n  config?: IAudioPlayerConfig;\n  singleTrack?: boolean;\n}\n\nconst AudioPlayer: React.FunctionComponent<IProps> = ({\n  playlist = [],\n  id = 'audio-player',\n  className,\n  eventRouter,\n  crossOrigin,\n  onEndNextFile = false,\n  config = {},\n  singleTrack = false,\n}: IProps) => {\n  const audioElem = React.useRef(null);\n  const timeElapsedElem = React.useRef(null);\n  const durationElem = React.useRef(null);\n\n  const [duration, setDuration] = React.useState(0);\n  const [timestamp, setTimestamp] = React.useState(0);\n  const [fileData, setFileData] = React.useState([]);\n  const [selectedFile, setSelectedFile] = React.useState(0);\n  const [progress, setProgress] = React.useState(0);\n  const [playing, setPlaying] = React.useState(false);\n  const [ended, setEnded] = React.useState(false);\n  const [muted, setMuted] = React.useState(false);\n  const [selectedLanguage, setSelectedLanguage] = React.useState(null);\n  const [showTrackListMenu, setShowTrackListMenu] = React.useState(false);\n  const [showSubtitleMenu, setShowSubtitleMenu] = React.useState(false);\n  const [videoMetadataLoaded, setVideoMetadataLoaded] = React.useState(false);\n\n  const captionsContainerId = `${id}__captions`;\n  const timeIndicatorId = `${id}__time-indicator`;\n  const durationIndicatorId = `${id}__duration-indicator`;\n  const tracklistId = `${id}__track-list`;\n  const subtitleMenuId = `${id}__subtitle-menu`;\n\n  const getTimestampString = (seconds: number = 0, isDuration: boolean = false): string => {\n    if (\n      config.useHoursInTimestamps\n      && ((isDuration && seconds >= 3600) || duration >= 3600)\n    ) {\n      return toHHMMSS(seconds.toString());\n    }\n    return toMMSS(seconds.toString());\n  };\n\n  React.useEffect(() => {\n    audioElem.current.setAttribute('playsinline', 'playsinline');\n  }, []);\n\n  React.useEffect(() => {\n    setFileData(playlist);\n    setSelectedFile(0);\n  }, [playlist]);\n\n  const canPlayPrev = selectedFile > 0;\n  const canPlayNext = selectedFile < fileData.length - 1;\n\n  React.useEffect(() => {\n    audioElem.current.load();\n    audioElem.current.currentTime = 0;\n    setProgress(0);\n  }, [selectedFile]);\n\n  const selectTrack = (trackNumber: number) => {\n    setPlaying(false);\n    setEnded(false);\n    setVideoMetadataLoaded(false);\n    setSelectedFile(trackNumber);\n  };\n\n  const hasVtt = (file: IPlaylistItem) => {\n    return file.transcriptUrl && file.transcriptUrl.length > 0;\n  };\n\n  const subtitleTracks = () => {\n    if (!videoMetadataLoaded) {\n      return [];\n    }\n    return audioElem.current.textTracks;\n  };\n\n  const playable = fileData && fileData.length && videoMetadataLoaded;\n\n  const selectSubtitleLanguage = (lang?: string) => {\n    setShowSubtitleMenu(false);\n    setSelectedLanguage(lang && lang.length ? lang : null);\n  };\n\n  const onLoadedMetadata = () => {\n    setVideoMetadataLoaded(true);\n    selectSubtitleLanguage(selectedLanguage);\n    setDuration(audioElem.current.duration);\n\n    // this.highlighter.selectedFile = this.state.selectedFile;\n    // this.highlighter.updateVideoElement(this.videoElement);\n    // this.highlighter.onVideoElementLoad();\n  };\n\n  const onTimeUpdate = () => {\n    if (duration > 0) {\n      const value =\n        (100 / duration) * audioElem.current.currentTime;\n      setProgress(value);\n      setTimestamp(audioElem.current.currentTime);\n    }\n  };\n\n  const playPauseAction = () => {\n    if (!playable) {\n      return;\n    }\n    let newPlaying = false;\n    if (audioElem.current.paused) {\n      audioElem.current.play();\n      newPlaying = true;\n    } else {\n      audioElem.current.pause();\n    }\n    setPlaying(newPlaying);\n    setTimestamp(audioElem.current.currentTime);\n    if (eventRouter) {\n      eventRouter.emit('state.playing', newPlaying);\n    }\n  };\n\n  const nextTrackAction = () => {\n    if (canPlayNext) {\n      selectTrack(selectedFile + 1);\n    }\n  };\n\n  const nextTrackAndPlayAction = () => {\n    if (canPlayNext) {\n      nextTrackAction();\n      setTimeout(() => playPauseAction(), 500);\n    }\n  };\n\n  const onEnded = () => {\n    if (onEndNextFile) {\n      nextTrackAndPlayAction();\n      return;\n    }\n    setEnded(true);\n    setTimestamp(audioElem.current.currentTime);\n    if (eventRouter) {\n      eventRouter.emit('state.playing', false);\n      eventRouter.emit('state.ended', true);\n    }\n  };\n\n  const moveBackwardAction = () => {\n    if (!playable) {\n      return;\n    }\n    audioElem.current.currentTime -= (config.rewindTime || 5);\n  };\n\n  const moveForwardAction = () => {\n    if (!playable) {\n      return;\n    }\n    audioElem.current.currentTime += (config.fastForwardTime || 5);\n  };\n\n  const rewindAction = () => {\n    audioElem.current.currentTime = 0;\n    setEnded(false);\n    setTimestamp(audioElem.current.currentTime);\n    setProgress(0);\n    if (eventRouter) {\n      eventRouter.emit('state.ended', false);\n    }\n  };\n\n  React.useEffect(() => {\n    let i;\n    for (i = 0; i < audioElem.current.textTracks.length; i += 1) {\n      audioElem.current.textTracks[i].mode =\n        audioElem.current.textTracks[i].language === selectedLanguage\n          ? 'showing'\n          : 'hidden';\n    }\n  }, [selectedLanguage]);\n\n  const toggleMuteAction = () => {\n    const newMute = !audioElem.current.muted;\n    audioElem.current.muted = newMute;\n    setMuted(newMute);\n  };\n\n  const handleRemoteAction = (action: string) => {\n    if (action === 'backward') {\n      moveBackwardAction();\n    } else if (action === 'play_pause') {\n      playPauseAction();\n    } else if (action === 'reset') {\n      rewindAction();\n    } else if (action === 'forward') {\n      moveForwardAction();\n    }\n  };\n\n  React.useEffect(() => {\n    if (eventRouter) {\n      eventRouter.on('remote.action', handleRemoteAction);\n    }\n    return () => {\n      if (eventRouter) {\n        eventRouter.off('remote.action', handleRemoteAction);\n      }\n    };\n  }, []);\n\n  const currentFile = fileData[selectedFile] || null;\n\n  return (\n    <div className={CssClasses('video-wrapper', className)}>\n      <audio\n        className={CssClasses('video-element', className)}\n        data-oh-audio-player=\"1\"\n        crossOrigin={crossOrigin}\n        preload=\"metadata\"\n        ref={audioElem}\n        onLoadedMetadata={onLoadedMetadata}\n        onEnded={onEnded}\n        onTimeUpdate={onTimeUpdate}\n        aria-describedby={captionsContainerId}\n      >\n        {currentFile && <source src={currentFile.audioUrl} type=\"audio/mpeg\" />}\n        {currentFile && hasVtt(currentFile) && (\n          <track\n            src={currentFile.transcriptUrl}\n            kind=\"captions\"\n            label=\"English\"\n            srcLang=\"en\"\n          />\n        )}\n      </audio>\n\n      <div className={CssClasses('video-controls', className)}>\n        <ScrubBar\n          defaultValue={progress}\n          className=\"video-controls__progress-bar\"\n          onClick={(pos: number) => {\n            audioElem.current.currentTime = pos * duration;\n            setTimestamp(pos * duration);\n          }}\n        />\n\n        <label className=\"sr-only\" htmlFor={timeIndicatorId}>\n          Time elapsed\n        </label>\n\n        <input\n          className={CssClasses('video-controls', className, 'time-elapsed')}\n          id={timeIndicatorId}\n          readOnly\n          ref={timeElapsedElem}\n          value={getTimestampString(timestamp)}\n        />\n\n        {config.showDuration && (\n          <>\n            <label className=\"sr-only\" htmlFor={durationIndicatorId}>\n              Duration\n            </label>\n\n            <input\n              className={CssClasses('video-controls', className, 'duration')}\n              id={durationIndicatorId}\n              readOnly\n              ref={durationElem}\n              value={getTimestampString(duration, true)}\n            />\n          </>\n        )}\n\n        <div className=\"w-100\" />\n\n        <div className={CssClasses('video-controls', className, 'button-wrapper')}>\n          <ToggleButton\n            btnType=\"tracklist\"\n            aria-controls={tracklistId}\n            enabled={fileData.length > 0 && !singleTrack}\n            onClick={() => {\n              setShowSubtitleMenu(false);\n              setShowTrackListMenu(!showTrackListMenu);\n            }}\n            toggleState={showTrackListMenu}\n            config={config}\n          >\n            Tracklist\n          </ToggleButton>\n\n          <div className={CssClasses('video-controls', className, 'button-wrapper__space')} />\n\n          <ActionButton\n            btnType=\"previous-audio\"\n            enabled={fileData.length > 1 && canPlayPrev}\n            onClick={() => {\n              if (canPlayPrev) {\n                selectTrack(selectedFile - 1);\n              }\n            }}\n            config={config}\n          >\n            Previous track\n          </ActionButton>\n\n          <ActionButton\n            btnType=\"backward\"\n            onClick={moveBackwardAction}\n            config={config}\n          >\n            Rewind\n          </ActionButton>\n\n          <ToggleButton\n            btnType=\"play\"\n            hidden={ended}\n            onClick={playPauseAction}\n            toggleState={playing}\n            config={config}\n          >\n            {playing ? 'Pause' : 'Play'}\n          </ToggleButton>\n\n          <ActionButton\n            btnType=\"reset\"\n            enabled={ended}\n            hidden={!ended}\n            onClick={rewindAction}\n            config={config}\n          >\n            Restart\n          </ActionButton>\n\n          <ActionButton\n            btnType=\"forward\"\n            onClick={moveForwardAction}\n            config={config}\n          >\n            Fast forward\n          </ActionButton>\n\n          <ActionButton\n            btnType=\"next-audio\"\n            enabled={fileData.length > 1 && canPlayNext}\n            onClick={nextTrackAction}\n            config={config}\n          >\n            Next track\n          </ActionButton>\n\n          <ToggleButton\n            btnType=\"closed-captioning\"\n            aria-controls={subtitleMenuId}\n            enabled={videoMetadataLoaded && hasVtt(currentFile)}\n            onClick={() => {\n              setShowTrackListMenu(false);\n              setShowSubtitleMenu(!showSubtitleMenu);\n            }}\n            toggleState={showSubtitleMenu}\n            config={config}\n          >\n            Closed captioning\n          </ToggleButton>\n\n          <div className={CssClasses('video-controls', className, 'button-wrapper__space')} />\n\n          <ToggleButton\n            btnType=\"mute\"\n            onClick={toggleMuteAction}\n            toggleState={muted}\n            config={config}\n          >\n            Mute\n          </ToggleButton>\n        </div>\n      </div>\n\n      <SubtitleMenu\n        visible={showSubtitleMenu}\n        id={subtitleMenuId}\n        tracks={subtitleTracks()}\n        selected={selectedLanguage}\n        onSelect={selectSubtitleLanguage}\n      />\n\n      <TracklistMenu\n        visible={!singleTrack && showTrackListMenu}\n        id={tracklistId}\n        tracklist={fileData}\n        selected={selectedFile}\n        onSelect={(trackNumber) => {\n          setShowTrackListMenu(false);\n          selectTrack(trackNumber);\n        }}\n      />\n\n      <SubtitleContainer\n        visible={selectedLanguage !== null}\n        lang={selectedLanguage}\n        tracks={subtitleTracks()}\n        id={captionsContainerId}\n      />\n    </div>\n  );\n};\n\nexport default AudioPlayer;\n\nexport const defaultConfigs = {\n  FontAwesome5,\n};\n"],"names":["SrOnly","config","children","classNames","concat","React","className","join","CssClasses","defaultClassName","optionalClassName","suffix","states","classes","split","filter","c","length","map","reduce","agg","s","state","ActionButton","enabled","hidden","btnType","onClick","iconClassNames","icons","iconElem","iconElements","disabled","clampNumber","num","min","max","Math","getOffsetXNative","e","container","offsetX","rect","getBoundingClientRect","type","pageX","left","targetTouches","getOffsetX","nativeEvent","touchE","target","ON_CLICK_DEBOUNCE","ScrubBar","defaultValue","outer","useRef","scrubbing","useState","value","setValue","setOffsetX","lastUpdate","setLastUpdate","debouncedOnClick","debounce","onDown","current","onUp","Date","getTime","onMouseMove","onTouchMove","useEffect","document","addEventListener","removeEventListener","pos","clientWidth","onMouseDown","onTouchStart","ref","style","width","memoiseTrack","track","kind","mode","language","cues","SubtitleContainer","visible","lang","tracks","id","text","setText","currentTrack","setCurrentTrack","cueChange","activeCues","newText","cue","i","Menu","MenuItem","label","selected","onSelect","onKeyUp","key","SubtitleMenu","onSelectLang","itemElem","selectedLang","getAttribute","languageOptions","push","ToggleButton","toggleState","iconClassNamesFalse","iconClassNamesTrue","iconElemFalse","iconElemTrue","TracklistMenu","tracklist","onSelectTrack","indexAttr","index","parseInt","trackOptions","strPadLeft","n","toString","toHHMMSS","str","secNum","hours","floor","minutes","seconds","toMMSS","AudioPlayer","playlist","eventRouter","crossOrigin","onEndNextFile","singleTrack","audioElem","timeElapsedElem","durationElem","duration","setDuration","timestamp","setTimestamp","fileData","setFileData","selectedFile","setSelectedFile","progress","setProgress","playing","setPlaying","ended","setEnded","muted","setMuted","selectedLanguage","setSelectedLanguage","showTrackListMenu","setShowTrackListMenu","showSubtitleMenu","setShowSubtitleMenu","videoMetadataLoaded","setVideoMetadataLoaded","captionsContainerId","timeIndicatorId","durationIndicatorId","tracklistId","subtitleMenuId","getTimestampString","isDuration","useHoursInTimestamps","setAttribute","canPlayPrev","canPlayNext","load","currentTime","selectTrack","trackNumber","hasVtt","file","transcriptUrl","subtitleTracks","textTracks","playable","selectSubtitleLanguage","onLoadedMetadata","onTimeUpdate","playPauseAction","newPlaying","paused","play","pause","emit","nextTrackAction","nextTrackAndPlayAction","setTimeout","onEnded","moveBackwardAction","rewindTime","moveForwardAction","fastForwardTime","rewindAction","toggleMuteAction","newMute","handleRemoteAction","action","on","off","currentFile","preload","src","audioUrl","srcLang","htmlFor","readOnly","showDuration"],"mappings":"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"}